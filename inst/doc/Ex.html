<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19024" />

<meta name="date" content="2020-01-02" />

<title>Illustration</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Illustration</h1>
<h4 class="author">19024</h4>
<h4 class="date">2020-01-02</h4>



<div id="section" class="section level1">
<h1>9-20</h1>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>1.Go through “R for Beginners” if you are not familiar with R programming.</p>
<p>2.Use knitr to produce at least 3 examples(texts, figures, tables)</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<p>1.I’m already familiar with R programming and I have read that book before.</p>
<p>2.1 texts</p>
<p>This example computes the mean value and the varianve of 1000 samples. They are simulated using ‘rnorm’ function.</p>
<span class="math display">\[\begin{eqnarray*}
n &amp;=&amp; 1000
\\
\overline{X} &amp;=&amp; \frac{1}{n}\sum_{i = 1}^{n}X_i 
 \\

S_{n-1}^2 &amp;=&amp; \frac{1}{n-1}\sum_{i = 1}^{n}{(X_i - \overline{X})}^2
\end{eqnarray*}\]</span>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>) <span class="co">#simulate 100 data</span>
x_mean =<span class="st"> </span><span class="kw">mean</span>(x)
x_var =<span class="st"> </span><span class="kw">var</span>(x)
text1 =<span class="st"> </span><span class="kw">paste</span>(<span class="st">'mean:'</span>,x_mean, <span class="dt">sep =</span> <span class="st">''</span>)
text2 =<span class="st"> </span><span class="kw">paste</span>(<span class="st">'var:'</span>, x_var, <span class="dt">sep =</span> <span class="st">''</span>)
<span class="kw">print</span>(text1)</code></pre></div>
<pre><code>## [1] &quot;mean:-0.0290066166735253&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(text2)</code></pre></div>
<pre><code>## [1] &quot;var:1.00481675157269&quot;</code></pre>
<p>2.2 figures</p>
<p>This is a graph of the probability density function of <span class="math inline">\(\chi^2_{3}\)</span> distribution.</p>
<p><span class="math inline">\(\chi^2_{3}\)</span> ~ <span class="math inline">\(\Gamma(\frac{3}{2},\frac{1}{2})\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">return</span>(<span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>pi<span class="op">^</span>(<span class="op">-</span><span class="fl">0.25</span>)<span class="op">*</span>x<span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>))
}
x =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">5</span>, <span class="dt">by=</span><span class="fl">0.01</span>) <span class="co">#cut the interval</span>
y =<span class="st"> </span><span class="kw">f</span>(x)
<span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">'l'</span>) <span class="co">#plot</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////Q1+OSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGQklEQVR4nO3dfUPjNACA8Xl46qFwTqsF9v2/p9sKArslT9ImbdY+z194jGz9kXZ9Y+4OFm239AtoPYEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGgwkC7m2kpoLLD1UsgSCCoZaCsTUCtWgV6s8nbUFaoTaALkyWJWgS6xrGYUYNAAYqFiNoDCjssQtQcUBRhAaKZgXAPngRmF2psBiUs/8xEbQElLfy861ljQIk/PKNQU0DpL2Y+otsEmnEStQSU9xQzEd0u0ExCDQFlP8MsW6JbBpplErUDNOoJ6gvdOFB9omaARo9fWej2gSpvq1cAVHcStQI0bfiKQusAqriarQSo3iSqBPTyOJw3/PJ32nAFlq6SUB2gbvdt+KJ/+wKGK7FwdVazKkAvj/+zdHf/pgxX6ox3kWE+j1n8gcee7x/evuwDK9ku8l/jqyDUxgwqt1zFiWptg16nUOI2qOBSlRaq9C72fD+8iwXmT0Wg0tvqJvaDSo9d1Lv4A0cMV3y7UXKVLf7AEcMVf+8puJqtE6jgJKq0H/R+k0LCflCVY4RSQnVm0Mtj8CDsynC1DjOLjFvtYPXn9OGqnakocoRX/IFD/e7h2j9fvT+o4tmu6UM3sJGuekZ5+nmm4g/MHq7qVYnJb/hrB5o8iWoDdfw2Xxlo4hOsfwYdpk2iTQBN2RJtA2jCJFr+qsYsPuMn0fJXNWYCGjuJ8oGOR6JwGJF3Tno2oHFEY2ZQd5yugYkxlHVVY0agMUIjV7G4Uasz6DCCaPQ2qIttgnOuaswLlE00Dqg/6jwcJ0rwokXGVY25gTKFRgCdFn5Y8NAGJme42X0OeURj3sV++jPv9USHWwIoh2jxPellgNL3G7cKlEy0XaBEoi0DJW2Ktg2UQLR1ICRaGmhxH9oUCXSIEwk0FP6kg+QRCr2Si+FaAQrOIoHeu0ok0MeuTCOBPvcDkUCXXX48WPLPFX4ZdYYt0qe7c2YG+uH+oBaBDh+n0cIzqFGfwzuRQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQFAloNQ77bcKlHyn/UaB0u+T3ihQ+p32GwVyBlHJd9pvFSj1Tvv2fRbeDxIIhtsuUOKO4maBUncUtwqU/Da/VaDkHcWtAjmDqOCO4sX9QZsFyv2gyYZb+IRZ+wkE1QZK+PygtltsBt1MCwGlDQrfn/btqT8+7eFlBl0vEB6spg26WiA+WE0bdK1ACYcaaYOuFSjhYDVt0LUCOYMovqqRNuhqgfhgNW3Q9QJtMIEggSCBIIEggSCBIIEggSCBIIEggSCBoPJA/W4Hnwr79Gv4bNv5rHfkXEqHox/24XMNw9kI+uT1TxUH6o+vv48uw/N9+HTky+PxR7vwIpwuWMZHP/6CwkBPv2R/oG9poOGs4z7yS+pjF0Wevp5OyYWu2x5tv9H/w+s4ScJAIz4IujQQLOH5ZCS+zPgciQN1d9/DQF3W2nWuONB5EscJEGgffUAX4zs+f2QbtP8tvoW7Ummg4ZcfnwIEFD3j3UeX8LSGh4Ge70/f2mcJNQjUw9tM5DP3z1dbIjMo5ekvam8Vgysmhxj/+dkJaNhMpjb7RvoAQB1vI8JL2L3e2xIVyHuvn/9tPg7URRduoIF1JDyDkn78ogV2FGOv8OlrfP6cFv7DBd7gY0LfOv3ilt1IpxwMRIBe15HwAHtageLboIQfv8iDVUggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCCodaDTvWrnu6OXqnWg091S8c/BqFzrQIf+y1+/Z//9QMGaBzrs8/74pHTtA/WZ98wVrnmgl8c/8v8CpWDNA3V3/8BdrXVrHej0qVcj/oipXK0DDTdGL7iZbh1o8QSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIL+A/Lwn6XANe6fAAAAAElFTkSuQmCC" /><!-- --></p>
<p>2.3 table</p>
<p>This is a table of the coefficients in a linear regression.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">'cars'</span>) <span class="co">#load dataset</span>
<span class="kw">library</span>(knitr)
out =<span class="st"> </span><span class="kw">lm</span>(dist<span class="op">~</span>speed,cars)<span class="co">#fit linear model</span>
<span class="kw">kable</span>(<span class="kw">summary</span>(out)<span class="op">$</span>coefficients)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-17.579095</td>
<td align="right">6.7584402</td>
<td align="right">-2.601058</td>
<td align="right">0.0123188</td>
</tr>
<tr class="even">
<td>speed</td>
<td align="right">3.932409</td>
<td align="right">0.4155128</td>
<td align="right">9.463990</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div id="section-1" class="section level1">
<h1>9-30</h1>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<p>3.5 A discrete random variable X has probability mass function</p>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">p(x)</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.3</td>
</tr>
</tbody>
</table>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
<p>3.7 Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
<p>3.12 Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter 螞 has Gamma(r, 尾) distribution and Y has Exp(螞) distribution. That is, <span class="math inline">\((Y|\Lambda = \lambda) = f_Y(y|\lambda) = \lambda e^{-\lambda y}\)</span>. Generate 1000 random observations from this mixture with r = 4 and 尾 = 2.</p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div id="section-2" class="section level2">
<h2>3.5</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#genereate U(0,1), set seed = 357</span>
<span class="kw">set.seed</span>(<span class="dv">357</span>)
U =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)
<span class="co">#inverse tranformation</span>
U_sp =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">'numeric'</span>, <span class="dt">length=</span><span class="dv">1000</span>)
U_sp[U <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>] =<span class="st"> </span><span class="dv">0</span>
U_sp[U <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">&amp;</span><span class="st"> </span>U <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.1</span>] =<span class="st"> </span><span class="dv">1</span>
U_sp[U <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">&amp;</span><span class="st"> </span>U <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.3</span>] =<span class="st"> </span><span class="dv">2</span>
U_sp[U <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.7</span> <span class="op">&amp;</span><span class="st"> </span>U <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.5</span>] =<span class="st"> </span><span class="dv">3</span>
U_sp[U <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.7</span>] =<span class="st"> </span><span class="dv">4</span>
freq &lt;-<span class="st"> </span><span class="kw">table</span>(U_sp)
<span class="co"># add a row of theatrical result</span>
gene_prob =<span class="st"> </span>freq<span class="op">/</span><span class="dv">1000</span>
theory_prob =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)
tb =<span class="st"> </span><span class="kw">rbind</span>(freq,gene_prob, theory_prob)
knitr<span class="op">::</span><span class="kw">kable</span>(tb)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>freq</td>
<td align="right">113.000</td>
<td align="right">182.000</td>
<td align="right">196.000</td>
<td align="right">212.000</td>
<td align="right">297.000</td>
</tr>
<tr class="even">
<td>gene_prob</td>
<td align="right">0.113</td>
<td align="right">0.182</td>
<td align="right">0.196</td>
<td align="right">0.212</td>
<td align="right">0.297</td>
</tr>
<tr class="odd">
<td>theory_prob</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.300</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#generate with Rsample</span>
U_real =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">replace =</span> T, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>))
<span class="kw">table</span>(U_real) -&gt;<span class="st"> </span>freq2
gene_prob2 =<span class="st"> </span>freq2<span class="op">/</span><span class="dv">1000</span>
tb2 =<span class="st"> </span><span class="kw">rbind</span>(freq2, gene_prob2, theory_prob)
knitr<span class="op">::</span><span class="kw">kable</span>(tb2)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>freq2</td>
<td align="right">102.000</td>
<td align="right">229.000</td>
<td align="right">174.000</td>
<td align="right">185.000</td>
<td align="right">310.00</td>
</tr>
<tr class="even">
<td>gene_prob2</td>
<td align="right">0.102</td>
<td align="right">0.229</td>
<td align="right">0.174</td>
<td align="right">0.185</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td>theory_prob</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.30</td>
</tr>
</tbody>
</table>
</div>
<div id="section-3" class="section level2">
<h2>3.7</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># write a function</span>
BETA &lt;-<span class="st"> </span><span class="cf">function</span>(a,b,n){

  <span class="co">#let c = beta(a,b)</span>
  <span class="co">#compute c</span>
  result =<span class="st"> </span><span class="kw">vector</span>()
  <span class="co">#generate random variables until we have enough samples(n)</span>
  <span class="cf">while</span>(<span class="ot">TRUE</span>){
    c =<span class="st"> </span><span class="kw">factorial</span>(a<span class="op">+</span>b<span class="op">-</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(a<span class="op">-</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(b <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
  <span class="co">#generate variables</span>
    len =<span class="st"> </span>n<span class="op">*</span>c<span class="op">*</span><span class="dv">2</span> 
    U =<span class="st"> </span><span class="kw">runif</span>(len)
    G0 =<span class="st"> </span><span class="kw">runif</span>(len)
    F0 =<span class="st"> </span>c<span class="op">*</span>G0<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>G0)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>)
    result_temp =<span class="st"> </span>G0[(F0) <span class="op">&gt;=</span><span class="st"> </span>c<span class="op">*</span>U]
    result =<span class="st"> </span><span class="kw">c</span>(result, result_temp)
    <span class="cf">if</span>(<span class="kw">length</span>(result)<span class="op">&gt;=</span>n){
      <span class="cf">break</span>;
    }
  }
  <span class="kw">return</span>(result[<span class="dv">1</span><span class="op">:</span>n])
}

result =<span class="st"> </span><span class="kw">BETA</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)
<span class="co">#draw the density curve </span>
x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)
y =<span class="st"> </span>(x)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">1</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)
<span class="kw">par</span>(<span class="dt">new=</span>T)
<span class="kw">hist</span>(result, <span class="dt">breaks=</span><span class="dv">30</span>,<span class="dt">xlab =</span> <span class="st">''</span>, <span class="dt">probability =</span> T)
<span class="kw">curve</span>(<span class="kw">dbeta</span>(x,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-4" class="section level2">
<h2>3.12</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n =<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of sample</span>
r =<span class="st"> </span><span class="dv">4</span> 
beta =<span class="st"> </span><span class="dv">2</span> 

Lambda =<span class="st"> </span><span class="kw">rgamma</span>(n,r,beta)

Y =<span class="st"> </span><span class="kw">rexp</span>(n,Lambda)

<span class="kw">hist</span>(Y)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-5" class="section level1">
<h1>10-11</h1>
</div>
<div id="question-2" class="section level1">
<h1>Question</h1>
<div id="section-6" class="section level2">
<h2>5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\frac{\pi}{3}}sint dt\]</span> and compare your estimate with the exact value of the integral</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>Firstly, according to calculus, we have <span class="math display">\[\int_{0}^{\frac{\pi}{3}}sint dt = \frac{1}{2}\]</span> Since <span class="math inline">\(sinx = x + \frac{x^3}{6} + O(x^5)\)</span> So firstly, I use <span class="math inline">\(x - \frac{x^3}{6}\)</span> as the control variate and <span class="math display">\[E[x - \frac{x^3}{6}] = \int_{0}^{\frac{\pi}{3}}(x - \frac{x^3}{6})dx / \frac{\pi}{3} = \frac{\pi}{6} - \frac{\pi^3}{648}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">library</span>(ggplot2)
UP =<span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span>
U =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dv">0</span>, UP)
G =<span class="st"> </span><span class="kw">sin</span>(U)
CONTROL =<span class="st"> </span>U <span class="op">-</span><span class="st"> </span>U<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="dv">6</span>
ECONTROL =<span class="st"> </span>pi<span class="op">/</span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span>pi<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="dv">648</span>
L =<span class="st"> </span><span class="kw">lm</span>(G <span class="op">~</span><span class="st"> </span>CONTROL)
cstar =<span class="st"> </span>L<span class="op">$</span>coefficients[<span class="dv">2</span>]
G_adjust =<span class="st"> </span>G <span class="op">-</span><span class="st"> </span>cstar<span class="op">*</span>(CONTROL <span class="op">-</span><span class="st"> </span>ECONTROL)
result_adj =<span class="st"> </span><span class="kw">mean</span>(G_adjust)<span class="op">*</span>UP
result_<span class="dv">0</span> =<span class="st"> </span><span class="kw">mean</span>(G)<span class="op">*</span>UP
var_<span class="dv">0</span> =<span class="st"> </span><span class="kw">var</span>(G)<span class="op">*</span>UP<span class="op">^</span><span class="dv">2</span>
var_adjust =<span class="st"> </span><span class="kw">var</span>(G_adjust)<span class="op">*</span>UP<span class="op">^</span><span class="dv">2</span>
percentage_empirical =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>var_adjust<span class="op">/</span>var_<span class="dv">0</span>
percentage_theorical =<span class="st"> </span><span class="kw">summary</span>(L)<span class="op">$</span>r.squared
result =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(result_<span class="dv">0</span>,result_adj))
result =<span class="st"> </span><span class="kw">cbind</span>(result,<span class="kw">c</span>(<span class="kw">sqrt</span>(var_<span class="dv">0</span>),<span class="kw">sqrt</span>(var_adjust)))
result =<span class="st"> </span><span class="kw">cbind</span>(result, <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'unadjust'</span>,<span class="st">'adjust'</span>)
<span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'estimate'</span>,<span class="st">'standard error'</span>, <span class="st">'True'</span>)
<span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">estimate</th>
<th align="right">standard error</th>
<th align="right">True</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>unadjust</td>
<td align="right">0.5018227</td>
<td align="right">0.2691152</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td>adjust</td>
<td align="right">0.5000354</td>
<td align="right">0.0017450</td>
<td align="right">0.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">100</span><span class="op">*</span><span class="kw">c</span>(percentage_empirical,percentage_theorical) -&gt;tb
<span class="kw">names</span>(tb) &lt;-<span class="kw">c</span>(<span class="st">'empirical'</span>, <span class="st">'theorical'</span>)
tb =<span class="st"> </span><span class="kw">as.matrix</span>(tb)
<span class="kw">colnames</span>(tb) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'percentage of variance reduced(control variate)'</span>)
<span class="kw">kable</span>(tb)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">percentage of variance reduced(control variate)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>empirical</td>
<td align="right">99.9958</td>
</tr>
<tr class="even">
<td>theorical</td>
<td align="right">99.9958</td>
</tr>
</tbody>
</table>
<p>Secondly, I use importance sampling as a comparision method.</p>
<p>since the graph of sin(x) in the interval[0,<span class="math inline">\(\frac{\pi}{3}\)</span>] is like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># up is the upper bound(pi/3)</span>
x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,UP,<span class="fl">0.01</span>)
y =<span class="st"> </span><span class="kw">sin</span>(x)
data =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y))
g =<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(x,y))
g <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="fl">0.1</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>I use random variable X whose pdf likes this <span class="math display">\[f(x) = \frac{xI_{[0,\frac{\pi}{3}]}(x)}{\pi^2/18}\]</span></p>
<p>These are graphs pdf of X, g(x), and the quotient of g(x) and f(x)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y2 =<span class="st"> </span><span class="dv">18</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span><span class="op">*</span>x
y3 =<span class="st"> </span>y<span class="op">/</span>y2
data =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y,y2,y3))
g =<span class="st"> </span><span class="kw">ggplot</span>(data)
g <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x,y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x,y2), <span class="dt">color=</span><span class="st">'green'</span>)<span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x,y3), <span class="dt">color=</span><span class="st">'red'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The function to generate R.V. whose pdf is f(X) and do the importance sampling</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  C =<span class="st"> </span>pi<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">9</span>
  U =<span class="st"> </span><span class="kw">runif</span>(n)
  <span class="kw">return</span>(<span class="kw">sqrt</span>(U<span class="op">*</span>C))
}
X =<span class="st"> </span><span class="kw">rf</span>(<span class="dv">10000</span>)
G_imp =<span class="st"> </span><span class="kw">sin</span>(X)
f_imp =<span class="st"> </span><span class="dv">18</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span><span class="op">*</span>X
result_imp =<span class="st"> </span><span class="kw">mean</span>(G_imp<span class="op">/</span>f_imp)
var_imp =<span class="st"> </span><span class="kw">var</span>(G_imp<span class="op">/</span>f_imp)
result_imp =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(result_<span class="dv">0</span>,result_imp))
result_imp =<span class="st"> </span><span class="kw">cbind</span>(result_imp,<span class="kw">c</span>(<span class="kw">sqrt</span>(var_<span class="dv">0</span>),<span class="kw">sqrt</span>(var_imp)))
result_imp =<span class="st"> </span><span class="kw">cbind</span>(result_imp, <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="kw">rownames</span>(result_imp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'unadjust'</span>,<span class="st">'adjust'</span>)
<span class="kw">colnames</span>(result_imp) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'estimate'</span>,<span class="st">'standard error'</span>, <span class="st">'True'</span>)
<span class="kw">kable</span>(result_imp)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">estimate</th>
<th align="right">standard error</th>
<th align="right">True</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>unadjust</td>
<td align="right">0.5018227</td>
<td align="right">0.2691152</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td>adjust</td>
<td align="right">0.5001043</td>
<td align="right">0.0274925</td>
<td align="right">0.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())<span class="co">#rmove all the data and variables in this question</span></code></pre></div>
</div>
<div id="question-5.10" class="section level2">
<h2>Question 5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1}{\frac{e^{-x}}{1+x^2}dx}\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-5.10" class="section level2">
<h2>Answer 5.10</h2>
<p>I generate X ~ U(0,1), and Y = 1-X, so X and Y are negatively correlated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)
Y =<span class="st"> </span><span class="dv">1</span><span class="op">-</span>X
G1 =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>X)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>X<span class="op">^</span><span class="dv">2</span>)
G2 =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>Y)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>Y<span class="op">^</span><span class="dv">2</span>)
G =<span class="st"> </span>(G1<span class="op">+</span>G2)<span class="op">/</span><span class="dv">2</span>
X2 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)
G3 =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>X2)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>X2<span class="op">^</span><span class="dv">2</span>)
result_original =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(G1,G3)), <span class="kw">sd</span>(<span class="kw">c</span>(G1,G3)))
result_anti =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(G), <span class="kw">sd</span>(G))    
result =<span class="kw">matrix</span>(<span class="kw">c</span>(result_anti,result_original),<span class="dv">2</span>,<span class="dv">2</span>,<span class="dt">byrow =</span> T)
<span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'estimate'</span>, <span class="st">'standard error'</span>)
<span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'anti'</span>, <span class="st">'normal'</span>)
percentage_reduced =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(G)<span class="op">/</span><span class="kw">var</span>(<span class="kw">c</span>(G1,G3))
<span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">estimate</th>
<th align="right">standard error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anti</td>
<td align="right">0.5247972</td>
<td align="right">0.0331994</td>
</tr>
<tr class="even">
<td>normal</td>
<td align="right">0.5240195</td>
<td align="right">0.2448416</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(percentage_reduced)</code></pre></div>
<pre><code>## [1] 0.9816139</code></pre>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[f(x) = \frac{e^{-x}}{1-e^{-1}}\]</span> <span class="math display">\[F(x) = \frac{1-e^{-x}}{1-e^{-1}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#function of cdf X</span>
pdf &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))
}
cdf &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">return</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>x))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))
}
<span class="co"># function to generate random variable X folloing distribution f</span>
rf &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  U &lt;-<span class="st"> </span><span class="kw">runif</span>(n)
  <span class="kw">return</span>(<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>U))
}
<span class="co"># original method</span>
X =<span class="st"> </span><span class="kw">rf</span>(<span class="dv">10000</span>)
G =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>X)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>X<span class="op">^</span><span class="dv">2</span>)
f =<span class="st"> </span><span class="kw">pdf</span>(X)
result =<span class="st"> </span><span class="kw">mean</span>(G<span class="op">/</span>f)
v =<span class="st"> </span><span class="kw">var</span>(G<span class="op">/</span>f)
<span class="co"># stratified importance sampling</span>
X0 =<span class="st"> </span><span class="kw">rf</span>(<span class="dv">20000</span>)
f_s =<span class="st"> </span>G_s =<span class="st"> </span><span class="kw">list</span>(<span class="dv">5</span>)
X_s =<span class="st"> </span><span class="kw">list</span>(<span class="dv">5</span>)
result_s =<span class="st"> </span>var_s =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">'numeric'</span>,<span class="dt">length =</span> <span class="dv">5</span>)
X_s[[<span class="dv">1</span>]] =<span class="st"> </span>X0[<span class="kw">cdf</span>(X0)<span class="op">&lt;=</span><span class="fl">0.2</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>]
X_s[[<span class="dv">2</span>]] =<span class="st"> </span>X0[<span class="kw">cdf</span>(X0)<span class="op">&gt;</span><span class="fl">0.2</span><span class="op">&amp;</span><span class="kw">cdf</span>(X0)<span class="op">&lt;=</span><span class="fl">0.4</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>]
X_s[[<span class="dv">3</span>]] =<span class="st"> </span>X0[<span class="kw">cdf</span>(X0)<span class="op">&gt;</span><span class="fl">0.4</span><span class="op">&amp;</span><span class="kw">cdf</span>(X0)<span class="op">&lt;=</span><span class="fl">0.6</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>]
X_s[[<span class="dv">4</span>]] =<span class="st"> </span>X0[<span class="kw">cdf</span>(X0)<span class="op">&gt;</span><span class="fl">0.6</span><span class="op">&amp;</span><span class="kw">cdf</span>(X0)<span class="op">&lt;=</span><span class="fl">0.8</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>]
X_s[[<span class="dv">5</span>]] =<span class="st"> </span>X0[<span class="kw">cdf</span>(X0)<span class="op">&gt;</span><span class="fl">0.8</span><span class="op">&amp;</span><span class="kw">cdf</span>(X0)<span class="op">&lt;=</span><span class="dv">1</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>]
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){
  G_s[[i]] =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>X_s[[i]])<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>X_s[[i]]<span class="op">^</span><span class="dv">2</span>)
  f_s[[i]] =<span class="st"> </span><span class="kw">pdf</span>(X_s[[i]])<span class="op">*</span><span class="dv">5</span>
  result_s[i] =<span class="st"> </span><span class="kw">mean</span>(G_s[[i]]<span class="op">/</span>f_s[[i]])
  var_s[i] =<span class="st"> </span><span class="kw">var</span>(G_s[[i]]<span class="op">/</span>f_s[[i]])
}
est_s  =<span class="st"> </span><span class="kw">sum</span>(result_s)
v_s =<span class="st"> </span><span class="kw">sum</span>(var_s)
est_importance =<span class="st"> </span><span class="kw">c</span>(result,<span class="kw">sqrt</span>(v))
est_stratify_importance =<span class="st"> </span><span class="kw">c</span>(est_s,<span class="kw">sqrt</span>(v_s))
mt =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbind</span>(est_importance,est_stratify_importance))
<span class="kw">colnames</span>(mt) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'est'</span>, <span class="st">'sd'</span>)
<span class="kw">kable</span>(mt)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">est</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>est_importance</td>
<td align="right">0.5255146</td>
<td align="right">0.0968406</td>
</tr>
<tr class="even">
<td>est_stratify_importance</td>
<td align="right">0.5251765</td>
<td align="right">0.0093139</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-7" class="section level1">
<h1>10-18</h1>
</div>
<div id="question-3" class="section level1">
<h1>Question</h1>
<div id="section-8" class="section level2">
<h2>6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="section-9" class="section level2">
<h2>6.6</h2>
<p>6.6 Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b1} \approx\)</span> N(0, 6/n)</p>
</div>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<div id="section-10" class="section level2">
<h2>6.5</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">4257</span>)
<span class="kw">library</span>(ggplot2)
<span class="co"># get 1000 times of Chisq2(2) Sample and compute the confidence interval</span>
generate =<span class="st"> </span><span class="cf">function</span>(n, alpha){
  X =<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)
  B =<span class="st"> </span><span class="kw">abs</span>(<span class="kw">sqrt</span>(<span class="kw">var</span>(X)<span class="op">/</span>n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="op">-</span><span class="dv">1</span>))
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(X)<span class="op">-</span>B,<span class="kw">mean</span>(X)<span class="op">+</span>B))
}
RESULT =<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> <span class="kw">generate</span>(<span class="dv">20</span>,<span class="fl">0.05</span>))
REALmean =<span class="st"> </span><span class="dv">2</span>
temp1 =<span class="st"> </span>RESULT[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span>
temp2 =<span class="st"> </span>RESULT[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span>
Proportion =<span class="st"> </span><span class="kw">sum</span>(temp1<span class="op">&amp;</span>temp2)<span class="op">/</span><span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span><span class="co"># the proportion that confidence interval contains the real mean</span>
knitr<span class="op">::</span><span class="kw">kable</span>(Proportion)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">91.7</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#this is the graph</span></code></pre></div>
<p>So the proportion that estimates are contained by the CI is about <span class="math inline">\(91.7 \%\)</span></p>
<p>Comparing with example 6.4 and 6.6, the confidence interval of <span class="math inline">\(\overline{X}\)</span> is more robust than the confidence interval of <span class="math inline">\(\sigma^2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="kw">t</span>(RESULT),<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>))
data_<span class="dv">0</span><span class="op">$</span>fac =<span class="st"> </span><span class="kw">as.factor</span>(temp1<span class="op">&amp;</span>temp2)
<span class="kw">ggplot</span>(data_<span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">x=</span>V3, <span class="dt">ymin=</span>V1,<span class="dt">ymax =</span> V2,<span class="dt">color=</span>fac),<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-11" class="section level2">
<h2>6.6</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">getskewness =<span class="st"> </span><span class="cf">function</span>(N){
  <span class="co">#N is the sample size of the N(0,1) distribution</span>
  X =<span class="st"> </span><span class="kw">rnorm</span>(N)
  m =<span class="st"> </span><span class="kw">mean</span>(X)
  A =<span class="st"> </span><span class="kw">sum</span>((X <span class="op">-</span><span class="st"> </span>m)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>N
  B =<span class="st"> </span>(<span class="kw">sum</span>((X<span class="op">-</span>m)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>N)<span class="op">^</span><span class="fl">1.5</span>
  <span class="kw">return</span> (A<span class="op">/</span>B)
}
n =<span class="st"> </span><span class="dv">2000</span>
m =<span class="st"> </span><span class="dv">10000</span>
<span class="co">#generate the samples</span>
Y =<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> <span class="kw">getskewness</span>(n))
<span class="co"># f(x) in F(x) = p, using normal distribution as an approximation</span>
sigma =<span class="st"> </span><span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)
p =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)
Z =<span class="st"> </span><span class="kw">sort</span>(Y)
place_est =<span class="st"> </span>Z[p<span class="op">*</span>m]
density_est =<span class="st"> </span><span class="kw">dnorm</span>(place_est, <span class="dv">0</span>, <span class="kw">sqrt</span>(sigma))
place_sd =<span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>m<span class="op">/</span>density_est<span class="op">^</span><span class="dv">2</span>)
place_limit =<span class="st"> </span><span class="kw">qnorm</span>(p,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))
<span class="co">#draw the table</span>
result =<span class="st"> </span><span class="kw">rbind</span>(place_est,place_limit,place_sd)
<span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'0.025'</span>,<span class="st">'0.05'</span>,<span class="st">'0.95'</span>,<span class="st">'0.975'</span>)
<span class="kw">rownames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'Monte Carlo estimation'</span>, <span class="st">'Limit estimation'</span>,<span class="st">'se for Monte Carlo estimation'</span> )
knitr<span class="op">::</span><span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.025</th>
<th align="right">0.05</th>
<th align="right">0.95</th>
<th align="right">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Monte Carlo estimation</td>
<td align="right">-0.1074956</td>
<td align="right">-0.0884581</td>
<td align="right">0.0895816</td>
<td align="right">0.1054445</td>
</tr>
<tr class="even">
<td>Limit estimation</td>
<td align="right">-0.1073516</td>
<td align="right">-0.0900923</td>
<td align="right">0.0900923</td>
<td align="right">0.1073516</td>
</tr>
<tr class="odd">
<td>se for Monte Carlo estimation</td>
<td align="right">0.0014770</td>
<td align="right">0.0011052</td>
<td align="right">0.0011427</td>
<td align="right">0.0013730</td>
</tr>
</tbody>
</table>
<p>The estimating result is close to the limit situation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data0 =<span class="st"> </span><span class="kw">as.data.frame</span>(Y)
X =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>)
N_X =<span class="st"> </span><span class="kw">dnorm</span>(X,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) 
data1 =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(X,N_X))
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> data0,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Y,<span class="dt">y=</span>..density..),<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> data1, <span class="kw">aes</span>(X,N_X, <span class="dt">color =</span> <span class="st">'red'</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-12" class="section level1">
<h1>11-1</h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\mu)\)</span>?</p>
</div>
<div id="answer-6.7" class="section level2">
<h2>Answer 6.7</h2>
</div>
</div>
<div id="it-seems-that-there-are-two-different-understandings-for-this-questionsimple-beta-distribution-and-the-mixture-distribution-so-i-answer-the-questions-in-different-understandings-seperately." class="section level1">
<h1>It seems that there are two different understandings for this question(simple Beta distribution and the mixture distribution), so I answer the questions in different understandings seperately.</h1>
</div>
<div id="pure-beta-distribution" class="section level1">
<h1>Pure beta distribution</h1>
<p>Firstly, I write a function to simulate the power given the parameter <span class="math inline">\(\alpha\)</span>. I use a sample size n = 100, time of replicates m = 10000 and set the threshold to 0.05.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="co">#cunction to compute skewness</span>
  skew &lt;-<span class="st"> </span><span class="cf">function</span>(X){
    M =<span class="st"> </span><span class="kw">mean</span>(X)
    m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((X <span class="op">-</span><span class="st"> </span>M)<span class="op">^</span><span class="dv">3</span>)
    m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((X <span class="op">-</span><span class="st"> </span>M)<span class="op">^</span><span class="dv">2</span>)
    <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)
  }
<span class="co">#beta distribution</span>
POW &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){
  m =<span class="st"> </span><span class="dv">10000</span>
  n =<span class="st"> </span><span class="dv">100</span>
  threshold =<span class="st"> </span><span class="fl">0.05</span>
  DATA =<span class="st"> </span><span class="kw">list</span>()
  SK =<span class="st"> </span><span class="kw">numeric</span>(m)
  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>threshold<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    DATA[[i]] =<span class="st"> </span><span class="kw">rbeta</span>(n,alpha,alpha)
  }
  SK =<span class="st"> </span><span class="kw">sapply</span>(DATA, skew)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(SK)<span class="op">&gt;=</span>cv)<span class="op">/</span>m,SK))
}
<span class="co">#t distribution</span>
POW2 &lt;-<span class="st"> </span><span class="cf">function</span>(miu){
  m =<span class="st"> </span><span class="dv">10000</span>
  n =<span class="st"> </span><span class="dv">100</span>
  threshold =<span class="st"> </span><span class="fl">0.05</span>
  DATA =<span class="st"> </span><span class="kw">list</span>()
  SK =<span class="st"> </span><span class="kw">numeric</span>(m)
  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>threshold<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    DATA[[i]] =<span class="st"> </span><span class="kw">rt</span>(n,miu)
  }
  SK =<span class="st"> </span><span class="kw">sapply</span>(DATA, skew)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(SK)<span class="op">&gt;=</span>cv)<span class="op">/</span>m,SK))
}
<span class="co">#normal distribution</span>
POW_N &lt;-<span class="st"> </span><span class="cf">function</span>(){
  m =<span class="st"> </span><span class="dv">10000</span>
  n =<span class="st"> </span><span class="dv">100</span>
  threshold =<span class="st"> </span><span class="fl">0.05</span>
  DATA =<span class="st"> </span><span class="kw">list</span>()
  SK =<span class="st"> </span><span class="kw">numeric</span>(m)
  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>threshold<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    DATA[[i]] =<span class="st"> </span><span class="kw">rnorm</span>(n)
  }
  SK =<span class="st"> </span><span class="kw">sapply</span>(DATA, skew)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(SK)<span class="op">&gt;=</span>cv)<span class="op">/</span>m,SK))
}</code></pre></div>
<p>for alpha = 1,10,20 compute the power;for miu = 2,5,10,compute the power</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">6</span>)
p[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">POW</span>(<span class="dv">1</span>)[[<span class="dv">1</span>]]
p[<span class="dv">2</span>] =<span class="st"> </span><span class="kw">POW</span>(<span class="dv">10</span>)[[<span class="dv">1</span>]]
p[<span class="dv">3</span>] =<span class="st"> </span><span class="kw">POW</span>(<span class="dv">20</span>)[[<span class="dv">1</span>]]
p[<span class="dv">4</span>] =<span class="st"> </span><span class="kw">POW2</span>(<span class="dv">2</span>)[[<span class="dv">1</span>]]
p[<span class="dv">5</span>] =<span class="st"> </span><span class="kw">POW2</span>(<span class="dv">5</span>)[[<span class="dv">1</span>]]
p[<span class="dv">6</span>] =<span class="st"> </span><span class="kw">POW2</span>(<span class="dv">10</span>)[[<span class="dv">1</span>]]
<span class="kw">names</span>(p) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'beta1'</span>,<span class="st">'beta10'</span>,<span class="st">'beta20'</span>,<span class="st">'t2'</span>,<span class="st">'t5'</span>,<span class="st">'t10'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(p)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>beta1</td>
<td align="right">0.0016</td>
</tr>
<tr class="even">
<td>beta10</td>
<td align="right">0.0242</td>
</tr>
<tr class="odd">
<td>beta20</td>
<td align="right">0.0300</td>
</tr>
<tr class="even">
<td>t2</td>
<td align="right">0.8128</td>
</tr>
<tr class="odd">
<td>t5</td>
<td align="right">0.4034</td>
</tr>
<tr class="even">
<td>t10</td>
<td align="right">0.1995</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot the density of normal,beta,t distribution</span>
x =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="fl">0.05</span>)
y_norm =<span class="st"> </span><span class="kw">dnorm</span>(x)
y_<span class="dv">1</span> =<span class="st"> </span><span class="kw">dbeta</span>(x,<span class="dv">1</span>,<span class="dv">1</span>)
y_<span class="dv">2</span> =<span class="st"> </span><span class="kw">dbeta</span>(x,<span class="dv">10</span>,<span class="dv">10</span>)
y_<span class="dv">3</span> =<span class="st"> </span><span class="kw">dbeta</span>(x,<span class="dv">20</span>,<span class="dv">20</span>)
y_<span class="dv">4</span> =<span class="st"> </span><span class="kw">dt</span>(x,<span class="dv">2</span>)
y_<span class="dv">5</span> =<span class="st"> </span><span class="kw">dt</span>(x,<span class="dv">5</span>)
y_<span class="dv">6</span> =<span class="st"> </span><span class="kw">dt</span>(x,<span class="dv">10</span>)
DT =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y_norm,y_<span class="dv">1</span>,y_<span class="dv">2</span>,y_<span class="dv">3</span>,y_<span class="dv">4</span>,y_<span class="dv">5</span>,y_<span class="dv">6</span>))
<span class="kw">ggplot</span>(<span class="dt">data=</span>DT) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(x,y_<span class="dv">1</span>))<span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(x,y_<span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x,y_norm),<span class="dt">color=</span><span class="st">'red'</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmAGZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k///r6+v/AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T///+le+8ZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJNElEQVR4nO2di2LTNhiFxWUbBdbBtrKVsQsdpUBN15b6/V9tkSxbki3pyLFjyc45sMXkRJH85bfiWP4lUVNRidwNKF0EBERAQAQEREBABAS0N6DrTtZmT0FnBUUICBgEBAwCAgYBAYOAgEFAwEgCdPvLR/V4/+bk5ZfugYBa3Zy8UIAe/jyvP//YPhBQq8vn/zQRdP/7RxlM+oGABofY7a9f6vvf3uuH3RPf7RQrdwgJn5aoN2ZqQDcvFRn9oL2lP1sRfK7ACCIgF1ARfVDJgB7+PGu+xc4yfosVC0j+V8J5UJGAYpqpHckOAQGHgIBDQMAhIOAQEHAICDgEBBwCAg4BAYeAgENAwCEg4BAQcAgIOAQEHAICDgEBh4CAQ0DAISDgrA7Q0vI1NPvQc0wzfVDJzuoiaKZ2JDsEBBwCAg4BAYeAgENAwCEg4BAQcAgIOAQEHAICDgEBh4CAQ0DAISDgEBBwCAg4BAQcAgIOAQGHgIBDQMApEFCX3PP5ROpcPb5gvlgrN8lZ5mNenjOC7ACyEwxlKubDX+8te6Z2JDvlAXJSVGUo7Q45eaDVmbKek59coF4lO8lZPd7+bEfRTB9UsuOLoObJEiLopkvF7PqhmdqR7JQHyO6DLs/aZwmok5Xk3BxYMowe/i7paz4vIH0epLKemyNtdx70vPsim6kdyU6BgOKaqR3JDgEBh4CAQ0DAISDgEBBwCAg4BAQcAgIOAQGHgIBDQMAhIOAQEHAICDgEBBwCAg4BAYeAgENAwCEg4KwO0NIqb+gZaKYPKtlZXQTN1I5kh4CAQ0DAISDgEBBwCAg4BAQcAgIOAQGHgIBDQMAhIOAQEHAICDgEBJzsgO5Ou3XfHn8gIF8EXSWBOWJA9cWTTwTUbXkAjdJM7Uh2CAg4ZQG6+wl2RzO1I9kpEJBZsU9n8xa3hF9eQFZSb5Mklncp4/IAmYQ6nYdZ3jKieQGZlEydzZt1KWN/O7ONrEpAJqlXZ/NmXcpYeI1CIkjp8jzrUsYFAnK7nB2grH1QYYCkTFKvzubNupRxEYDuTh+9s/5pknp1Nm/O86AiAO1+rgqR+oN1pnakOoUAai4LPSOgWB8kESVcGZqpHalOMYCuhHiadGVopnakOmUA+vZWiFdy4ysOoZnakeoUAejudMRF15nakeoUAWiUZmpHqkNAwCEg4BAQcAgIOAQEHAICDgEBh4CAQ0DAIaC4U0kNnyYgrUpF0JAQATWq9CE2IERASpJL0wf1CRGQlKKiO+keoZIBLaZK/V84/2rFpN4uZtqveTeESo6gmdoBnR4glxABdTzMiaJNiIA6GgTkd7oAkuo9d01Aho+KIOE+eU1AXQ+tD7EBoWMHZPjoPkjYT18TUENCUbABWV33HLX4jTUAsgKo/RbrhRABXbdM2q95lxABdUcVAQ0dO4DMiaJDiIC6G+wJaOA4AWT91BDGJCCTodEDZOM7UkBuANnDPqJnHzMgk+LTB2T5BKS2rCLC9Y8TUI/PEFAz1jGxloixZkAmhI4XUK+LJqC+0w+g3s0LLaG8gExyz+1rtcDqgksZrwGQSXKWaYYyLXO5pYwHfHyA5C0Nk2qJGhiQSTC8kZguzxdcyhgBakMoKyA3RXW3teBSxtWgZb12Cv2qw489py1lrPIzl1vKeBhAgzvMrBAqIYLu35zpZxdZqbf7BjcqEJCV5Hz7uuuelwDkCaDhPYoNoZyATJKz5rPYUsbpgNRLM58H7YJInv/I7nmppYw9R5jnLtfudProzqR9ARQCJKojBTSY64WAOscbQL4bydWI9JECGk4WFAK0ezkBSflSEcRRAvLzCQO6rghIypvMIo4QUIBPKNuHgFr5AamXerKAZmhYwYD8890RkJI8XkYBErrbGlXLugF5+RBQI3lSMw7Q7s+RAfLziQIK9ULbAyR/WI0FJJ1jAhTgE/sWE6Evss0BqoIcCEhpT0B1iNAGAYlgEQLSPdA+gEIH2fYAiXCRKCB1WWhE9YsAml1VtC0BT7QPld+frnIiKD5MGo8gfwht6xADt2oAQOrqfXL1awRUVSJaBAHyEdoSoKpN2d0bkIfQhgBVIuS0woCGvdCWAMEiCYAGIbQdQCaApgAahNBmANkf/RRANujJDSsIkHNoTALUI7QRQG7XMRGQcz1pG4B658DTALmEtgBI9H8jTAQkCcFThhUBGl6nmA7IXLZdPSDhGRedCqghFP/ZshJAwk5fhkWSAek71KL3B68BkHDy33GRdEBtrln46uQKALUdafov8BGAuqT60BBS6YCE8M/5F32zMYDa961FiFHBgITpHXzT+84DSL913dWXWktmQGaiNmmMG+wbB8i5BV8MIZUHSLitrP3hE3mzsYBkBfb5er/+gDIAEsL3CY6+K2w0IM/Ni6Yp8wAySb16a8wSfqKVr+Wh8Ik0fQ9AgXpErGljAJmkXr0VX8pYuArurWr1+DODfQDVwc/C1+Re9RiQSajTW6FlRIMfR/9HgJmYfjFAbrXRWtRejAFkUjL1Vmgp4ypRYpL8jUwunthGTw1BQCapV29lXcp48SKTIoiApJL7oBXs7R5FMCCT1Ku3si5lXCAgaynjPc6DDtj0ZYokAIorX9OXKUJAwCAgYBAQMAgIGJMBGe0xldCKihAQKEJAoAgBgSLl3EheqAgIiICACAiIgIAmATKTuzpXQmLS08LWvZlhwxoMPh2gjtieTALUzRnojghF1E4LaxeOajD4dIA66tieTAFkpuV0r8ZGpKeFdQpHNbjwe4A6onsyBZCZ3NW9no+KqReawlENhg4OUEd0T6YAMpO7uiNCcclL207hqAaDTweoI7on+wK6PDlpjlQVy0mfblPETAtbp/QRe0XQyDrsF84aQeZtk/sHe1rYOqXxe/RBo+uwXzhrH2Qmd3VHhCIybXdnhg1qMPh0gDqiezL1POj5e3tgKKWE7A5lEWdm2LAGg08HqCO2JzyTBiIgIAICIiAgAgIiICACAiIgIAICIiCgVQC6evSuvjt9lqXuVQCqL57Kv1m0DkD/ff/HDx/yVL0OQPWVeJWp5pUAuhCZjrCVAPr6+N/TTCG0CkB3OzpfH+fphFYB6OLJp/rb2zwH2SoA5RQBAREQEAEBERAQAQEREBABAREQEAEB/Q8AcqcEHOOQSQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SK_N =<span class="st"> </span><span class="kw">POW_N</span>()[[<span class="dv">2</span>]]
SK_beta_<span class="dv">1</span> =<span class="st"> </span><span class="kw">POW</span>(<span class="dv">1</span>)[[<span class="dv">2</span>]]
SK_t_<span class="dv">2</span> =<span class="st"> </span><span class="kw">POW2</span>(<span class="dv">2</span>)[[<span class="dv">2</span>]]
SK =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(SK_N,SK_t_<span class="dv">2</span>,SK_beta_<span class="dv">1</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> SK) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>SK_N),<span class="dt">color=</span><span class="st">'red'</span>)<span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>SK_beta_<span class="dv">1</span>),<span class="dt">color=</span><span class="st">'blue'</span>)<span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>SK_t_<span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>we can see that for the heavy tail distribution like t-distribution, the power of skewness test is bigger since the skewness of it has higher variance. For distributions like beta(1,1), the variance of its skewness is very small, thus it’s hard to reject the hypothesis. For example, the emprical variance of skewness of beta(1,1) is 0.0212 while the theorical variance should be 0.0560(normal situation). as a contrast, the emprical variance of skewness of <span class="math inline">\(t_2\)</span> is 9.4397, which is much higher than the theorical result.</p>
</div>
<div id="mixture-of-beta-distribution-and-normal-distribution" class="section level1">
<h1>Mixture of Beta distribution and normal distribution</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#p is the probility of the beta distribution or t distribution</span>
POW2_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(alpha,p){
  m =<span class="st"> </span><span class="dv">10000</span>
  n =<span class="st"> </span><span class="dv">100</span>
  threshold =<span class="st"> </span><span class="fl">0.05</span>
  DATA =<span class="st"> </span><span class="kw">list</span>()
  SK =<span class="st"> </span><span class="kw">numeric</span>(m)
  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>threshold<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    flag =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">size=</span>n,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))
    DATA[[i]] =<span class="st"> </span><span class="kw">rbeta</span>(n,alpha,alpha)<span class="op">*</span>flag <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>flag)
  }
  SK =<span class="st"> </span><span class="kw">sapply</span>(DATA, skew)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(SK)<span class="op">&gt;=</span>cv)<span class="op">/</span>m,SK))
}
POW2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(miu,p){
  m =<span class="st"> </span><span class="dv">10000</span>
  n =<span class="st"> </span><span class="dv">100</span>
  threshold =<span class="st"> </span><span class="fl">0.05</span>
  DATA =<span class="st"> </span><span class="kw">list</span>()
  SK =<span class="st"> </span><span class="kw">numeric</span>(m)
  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>threshold<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    flag =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">size=</span>n,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))
    DATA[[i]] =<span class="st"> </span><span class="kw">rt</span>(n,miu)<span class="op">*</span>flag <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>flag)
  }
  SK =<span class="st"> </span><span class="kw">sapply</span>(DATA, skew)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(SK)<span class="op">&gt;=</span>cv)<span class="op">/</span>m,SK))
}
<span class="co">#p=0.01,0.1,0.5</span>
<span class="co">#alpha = 1,10</span>
<span class="co">#miu = 2,5</span>
result =<span class="st"> </span><span class="kw">list</span>()
result[[<span class="dv">1</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="kw">POW2_1</span>(<span class="dv">1</span>,<span class="fl">0.01</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_1</span>(<span class="dv">10</span>,<span class="fl">0.01</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">2</span>,<span class="fl">0.01</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">5</span>,<span class="fl">0.01</span>)[[<span class="dv">1</span>]])
result[[<span class="dv">2</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="kw">POW2_1</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_1</span>(<span class="dv">10</span>,<span class="fl">0.1</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">2</span>,<span class="fl">0.1</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">5</span>,<span class="fl">0.1</span>)[[<span class="dv">1</span>]])
result[[<span class="dv">3</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="kw">POW2_1</span>(<span class="dv">1</span>,<span class="fl">0.5</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_1</span>(<span class="dv">10</span>,<span class="fl">0.5</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">2</span>,<span class="fl">0.5</span>)[[<span class="dv">1</span>]],<span class="kw">POW2_2</span>(<span class="dv">5</span>,<span class="fl">0.5</span>)[[<span class="dv">1</span>]])
<span class="kw">names</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'proportion-0.01'</span>,<span class="st">'proportion-0.1'</span>,<span class="st">'proportion-0.5'</span>)
r =<span class="st"> </span><span class="kw">as.data.frame</span>(result)
<span class="kw">rownames</span>(r) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'alpha1'</span>,<span class="st">'alpha10'</span>,<span class="st">'miu2'</span>,<span class="st">'miu5'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(r)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">proportion.0.01</th>
<th align="right">proportion.0.1</th>
<th align="right">proportion.0.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>alpha1</td>
<td align="right">0.0572</td>
<td align="right">0.0985</td>
<td align="right">0.7596</td>
</tr>
<tr class="even">
<td>alpha10</td>
<td align="right">0.0494</td>
<td align="right">0.1128</td>
<td align="right">0.8279</td>
</tr>
<tr class="odd">
<td>miu2</td>
<td align="right">0.1043</td>
<td align="right">0.4241</td>
<td align="right">0.7777</td>
</tr>
<tr class="even">
<td>miu5</td>
<td align="right">0.0593</td>
<td align="right">0.1374</td>
<td align="right">0.3262</td>
</tr>
</tbody>
</table>
<div id="question-6.a" class="section level2">
<h2>Question 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : <span class="math inline">\(\mu = \mu0\)</span> vs H0 : <span class="math inline">\(\mu = \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-6.a" class="section level2">
<h2>Answer 6.A</h2>
<p>According to Calculus, the mean of <span class="math inline">\(\chi^2_1\)</span> distribution is 1; the mean of <span class="math inline">\(Uniform(0,2)\)</span> distribution is 1; the mean of <span class="math inline">\(Exp(1)\)</span> distribution is 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n =<span class="st"> </span><span class="dv">20</span>
Data1 =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)
Data2 =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)
Data3 =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)
Data4 =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){
Data1[i] =<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">rchisq</span>(n,<span class="dv">1</span>),<span class="dt">mu=</span><span class="dv">1</span>,<span class="dt">alternative =</span> <span class="st">'two.sided'</span>)<span class="op">$</span>p.value
Data2[i] =<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">mu=</span><span class="dv">1</span>,<span class="dt">alternative =</span> <span class="st">'two.sided'</span>)<span class="op">$</span>p.value
Data3[i] =<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">rexp</span>(n,<span class="dv">1</span>),<span class="dt">mu=</span><span class="dv">1</span>,<span class="dt">alternative =</span> <span class="st">'two.sided'</span>)<span class="op">$</span>p.value
Data4[i] =<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">mu=</span><span class="dv">1</span>,<span class="dt">alternative =</span> <span class="st">'two.sided'</span>)<span class="op">$</span>p.value
}
p1 =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(Data1)<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">10000</span>
p2 =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(Data2)<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">10000</span>
p3 =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(Data3)<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">10000</span>
p4 =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(Data4)<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">10000</span>
result =<span class="st"> </span><span class="kw">c</span>(p1,p2,p3,p4)
<span class="kw">names</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'Chi1'</span>,<span class="st">'U02'</span>,<span class="st">'exp1'</span>,<span class="st">'norm1'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Chi1</td>
<td align="right">0.1024</td>
</tr>
<tr class="even">
<td>U02</td>
<td align="right">0.0524</td>
</tr>
<tr class="odd">
<td>exp1</td>
<td align="right">0.0824</td>
</tr>
<tr class="even">
<td>norm1</td>
<td align="right">0.0487</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#y1 = t.test(X1, )</span></code></pre></div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particularsimulation setting with 10,000 experiments: say, 0.651 for onemethod and 0.676 for another method. Can we say the powersare different at 0.05 level?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p>The corresponding hypothesis test problem is: <span class="math inline">\(H_0\)</span>: method 1 has the same power as method2. <span class="math inline">\(H_1\)</span>: the powers of method 1 and method 2 are different.</p></li>
<li><p>I think we should use paired-t test. Because firstly, there is no evidence showing that the variance of the power of two methods are the same, which makes it questionable to use Z-test. Secondly, since the sample of two methods are not independent(both of them use the same data in one time), we can not use two-sample t test as well. Also, we have quantitative samples, which are not suitable for Mcnemar test.But for paired-t test, we can compare the power of two methods in each simulation and find out whether there are significant difference.</p></li>
<li><p>To test my hypothesis, I need several repeatment of the process that estimate the empirical power. And in order to make the paired-t test reasonable, I need to know whether the difference of the two methods follows normal distribution.</p></li>
</ol>
</div>
</div>
<div id="section-13" class="section level1">
<h1>11-8</h1>
</div>
<div id="question7.6" class="section level1">
<h1>Question7.6</h1>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1}, . . . , x_{i5})\)</span> for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: #Answer7.6</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(bootstrap)
<span class="kw">library</span>(corrplot)
<span class="kw">data</span>(scor)
<span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>mec,<span class="dt">y=</span>vec))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>mec,<span class="dt">y=</span>alg))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////JraURAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI/UlEQVR4nO2dDVvbNhDHXcpaUrpCt9J1DSvreEmgQFNA3/+rzXJebMuSTtLJtuT8/0+f0OR8Z+mHdJYVIRcCsqoYuwCpC4AIARAhACIEQIQAiJAnoPtazf8rsphCbYOHBCAA4oUEIADihQQgAOKFdAC0Op0dL4R4+jx7/wOAunr661Lcvf/xcjEXd7/nDqgoCk83GtDq0w/x9GVR/hOrPxZ5AyoKDaFILajiVP5XiN9KGY9OWxWgQFezaZ18Ht9vAUkN8evuIWQvLWj18VI8Hi/qFpQxoF5y0KbpTCIHBbg5t6CXi7MJXMX83WhA4nE2e3eJcZAZkE4xTh1kA6DUQgIQAPFCAhAA8UICEADxQgIQAPFCAhAA8UICEADxQgIQAPFCAhAA8UIC0P4B0n21A0C1TfvlIADVNgAibDxAiu8UAbFykEp3koA4IQGIMAEQZYqVg/ZPaEEGGwABEC8kAAFQdWUCILNtvfY3NCQAAVAAoN1wcS8A+eeg+oZjPwB5hwQgwgRAlGnPchArJABNHFBz/kboZ1ubfn38tU/SgFozgEI/X9/w6+XvxQBoKoCKAoBsOcjKZ29zUEM2PHt8FaulAOp8PRFYkukAulf5KF9wBZZkQoBaNgAibBMHRF6NaNukcxA5nolqAyDCNjYgQ105gDRWYlq1sgWUZABApsoycpAmJDUxL/2CSuIC6OWCs/NCWLF8Q44K6GYuNzgJ3YFq4BZk8qwBdY7gApLbvmx+BO3+MmgOMnru4HWP4AJaffouu9iQO1Ct20M/nqGxLYBO55LOkDtQhV/mrS3IEJvfgioyPe1Apa0PYyS98zSOpOPnoK897kCl/41ndi92U3WxfnagmgSgcgDU206cgwLafuJ+H5vAvZg+B7FCagM3ErhH40oAkK+NETIPQLuyRQLUrOsUANWFiwOoVVnXIUDKOWhUQP6myQLq3JWaR56JARomBxU7NT8IONtUr2IARNgASKro1HoSOYhr67SSiCG1NgCaDKBGt5GvAKSokXgbrx5D4sCS5Aso2ukSBmS6tri2oHvDQNGvKOkCMo5OjDlo46H0M8fThZUyH0BSDQ8A0mkPAO3q45uDFPf7ieag+jceZaDo7AZAMUJqbdEA6bpLJECdftWOZDmdk20YQNqES+UgtyJ3MrMSyXY6F1tagAJsBkCckB5ugwBqmTZvLMVqE5kIIFsOalVr+8Z6Kd86NG8qjGdxrGmgmw7Qrw/b255DP2wGVaG0b8yHr4+hDx5MrWIsD64lpqPncxMhr99NWAtqrZdr5HZNI9ocPmALOpE/Hg6uHyQpNqCgHLQjtPtkHVKThraH5wsowNbmkBigXRcTy9e3AKQBJB7k+U7E8tU3PR8SEJVnCFuhYti+6xian6Z9me+WOByQloLVQIYEICJkPED1IKgwZehBAalXQAVQo+8ZQxLdb5TpDn4OqgNpxgjN99t5M2OSphJ4UvNB3ja1zXRnQsYA9PMNs4s5ndrJpvY2N0DdfhkV0PN5eZNxshkupgNIV9GduQVP0y+jj6SvjsSDaZSYIqCWm+ZiFx3Q8lAY7zP2HpC4qugY7zOGBKROBqlu+st8d7QUF1CZhMRVYbzPGBSQ3eRyFfMMqdi0gGjFOHWQLXdA1kGLR7FcTbkBUrJj/4CcbjU8Q7ZtuQPqPWQfgHaQLL3PVqzuNajpZrZmAEj5HsvSuCzF0oxiGm4Waw6ApAAIgHiAkIMoQNwSJxUSgHIH5NIzC/LL2ukCcsnt22PGAyQ3V+pn5wXSlgegu9lchO5ApasOXazm0ekDWv359zx8BypmbTLIQS///ncxj7YD1XpiIj9Zynx3JrsXeweqor3UZzqX+WrvoGYLCgO0SyZ99oceQtKA7mZSZ9wc5H4vlhsgsb7Mc3egmjwg9jjI/WbVJaR6y5rJlKvXqYNsG5PaHnOZtPc6dZANgCobOefjBYjofhkCcpg19MhBVOuaJiAPW7qAbFOnjb5iqFJIbUzFsG6lPBog6+T7xk1/TIynIrQLIm2m8uQIyFbiYBsA5QYoPAf1NLRKLQeNcOPUQ0gAAiBeSAACIF5IAAIgXkgAGh1Q0PAssDY9hOwdUNgAP7A2PYQEIADihewdkHZytK/a9BCyf0CKpvfdPAABkM02OKA9yUH7J9xqGGwABEC8kAAEQLyQAARAvJAABEC8kAAEQLyQAARAvJAABEC8kAAEQLyQAARAvJAABEC8kAAEQLyQAARAvJAABEC8kGxA9J88RbVlB8j6R2F7Amh1OpsZd14AoGrLl9XHS8MOVAAkHiWVm7lp9xfkoE0rirUDVa4idn854+9AFceWZAt6+nwm2DtQRbKlCGh1OpeUIu2Cx7QlCGjNh70DVSRbgoDWe5jNR9qJc/SQDl1MpxinDrIBUGohAQiAeCEBCIB4IQEIgHghIwOKsl/rhAEp02cApMYHIADiAUIOogBFKXFSIQEIgHghAQiAeCEBCIB4IQGoH0ANBX4NPawb/3QARLgBEOEGQIQb9g8iBECEAIgQABECIEKBgFprYhylW1bspO5z4Ny8Zu8u/f3KUh4vGm5hgNprg92kXVbspO7zcF10Uz3h09dPlvKu6RYGqL0uz03aZcUu0jwP17GIASWtlmR+WdRuYYDaKzvd1VpW7Cj1ebjORfwuu5iv36YF1W5hgNprg53VXVbsIN3zcB0kl1iW1fT2Wyef2m3IFqRZVux0qu7zcN2L6H26j5fi8XjBbUEhOUi7rJiW9nm4LkX8WlXR12/TdLg5qL022E3aZcWOZ1Ofh+uim/m69fn5bVpQ7TbcOEi7rNhJYeOg0qE1oHHU46w9fMJImhAAEQIgQgBECIAIARAhACIEQIQAiBAAEUoS0M+3/7wpiqOf5cuJEM/nRXFwvf55OHhZ0gT05vWtWBby5eD6+byksnx9K3/++nAydFkSBXSyfXn77UG2npJM+d8xypImIMli+7KsVqkXRxWo4ZUBoLKnSQFQrRagh1ff6g+HV/qAns/LJlRSkkm6StjDKn1A1eVdtiJc5pMUABECIEIARAiACAEQIQAiBECEAIgQABH6HybneeQ8y4dpAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>mec,<span class="dt">y=</span>alg))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>mec,<span class="dt">y=</span>ana))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>mec,<span class="dt">y=</span>sta))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////JraURAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJiklEQVR4nO2di3bTOBCGDXShoWxbFsoC7lKgpQnphfTi93+1tWIntmRJo5tt2fr/09OmHWskfxmPJTlSswLSKhu7AbELgAgBECEAIgRAhACIkCWg20bt14I0Jlfb4C4BCID8XAIQAPm5BCAA8nMJQNEByrKst7MhbXXl6mLVAfvDRgCUZVXtowDaVa4sVh3QHGYEaHO6OFoWxeOnxbsbAOrq8d/LYv3u5vkiL9Z/A5AkgD7eFI+fl+VXsfln6Q1ofjmojqAtp/JlUfxVSnn0bKXJQVXyuX+3A8Q0yNsdhUsa0Ob9ZXF/tGwiCIB41aETLAf52SIEVEfQ88VZkLuYpy1CQMX9YvH2Mlg/yNMWIyCZQlTtZAOg2FwCEAD5uQQgAPJzCUAA5OcSgADIzyUAAZCfSwCaJCDZ1LGxS2nheQGSPnwwdSkvDEC3AGToMgVAyEHuNtzFYnMJQADk5zIlQIrUD0C1TdV56AXQFLUF5F7a7vDe3+4eXA4aQb2fTR8ukYP6cBknINehRquc4GJegFwHq61yogsAup0sIIfUmBQgp5trSjnIrffheDY9uASgsQG5dc8cz6YHl/0DCmsDoNhcAhAA+bmMFpBlbmeHJwXIsndQTYa5VQdARHXpAFKOT5pylk+lIwbkkIO0hIrmKLuWRAvI2pQUIJfRfEqA3OaDEspBXp8PsrbNCpBJlNjaJghImYNM8oy1zRvQ80U0a1bjBHSds6Xhofbu8LJFCYgtmK9/jL9uPsYctPn4g11i2LtDpc1pzuhg7w4loCp0sHeHSo9fsXeHFhC7i5Xhg7071CH0KeQeZp62GAHJFKJqJxsAxeYSgADIz2UKgIhnZskDoh4JARAA6W0ARNmQg/p0OTdAqhk1AKpsyjlZALoFIMHUJdEAktrcWjJZQJJY2ecghc2pJXMDRNpsWwJAcwWkzTPIQcO5HBrQ/r21OJt2PMwdUJMdzM+GyygA1LUBkLac8PHVuQOyzkHix3unAmgwVbNdESjW27zY5yuav4eqLq5LzNomkCj2f7X9wLNjS6IHJDcBEGEaGdCf19sGvPwVLaBxc9DT+eHT+cnD8Um8EdQR8eQiLCCG5uqwuHv1ezKAqGdf4QGtDoq7mC8xQcMCKq62dFZxRxCXhbSAwj84LJNQcZW9+KbkEwEg4T6mgZDoo2fzadXwgOr712g5SHIL58e4Gfe/UCmXe0AZ/y9CzVoZISDJqfOzJNVv5vPO9eW3LyYUtAW0ynY6GOcSMwRkXV0oQPsI0snMvwEg+eXkCyjrHBIUkIHM/NOApOdqlIN01e0uAcEWLAexEHo41g3F+gXkfdUqADm5lAIqO4qrsqM4QA6yAmQ83uobUBlAT+cDDTWkV4u8nMVwQpqD6GIymwLQw/FhdGMxC0BWNntA5UjjrhxnXI10m+8NEJXbpTYZIDZhdlBcacaq4ww1jHOQ3ObWfZIComXmf/DrQWubICBFzNu4bLuYHSBViy1cci6Gy0Gi2K4LPSzJHBqQvckU0HqRF9TWFPy5Vr9Jq64P1AJSXXuCS6E/qDlTtcMQgDYfvuTU1hT8yda/yareHajLQUpyvEuxw2w1QSB32bUZAHr+/vMip7amqDop8t80B7ofszvM/Ej6MK0LtWl9xi4vYmsKWQRJ37V2BDm84aoI0veReo2g7aYC7QiSApLkIEWrmhykbpZVDtq/GikHrRdMZ/ZbU2jftsC3HJ9hSKDbvP3WFIkBcugH6fiE7rToc1DfgLoKUbWTLYrpjikBylqrn0xdCpE9a0DZXuYuxdwIQEK5WQHq5HnBlDqgbk9BNCWeg2hAAaqbN6C2vZufArQybkBmOUjukoc7V0CUKVVAutE8Z0sUkG4+SLClmYMsAAWobuKAxE5L0y/kjveoboKACo4P3+3NuoQse9J2rYwTUPMSgAgbBShrTX4nCag7cBL5WA9W7VoSPSC9aSaAWlGwf+l2NpL71wwAta6J5qXT2Sju8FO/zfcJyKiY3hYfIPe3W9lHpFoSNyAhB/kkDGkOMmjJ4IDctT2lSL1pa7I73P29sYugzjVlPh9EN8Wo2OCArG453WGFWGweOcjZRgMKUB0AEbYpAyJzUIjqJg1ofJcABEB+LgEoEUAZPoKnNVVDjqAuaxsATRCQZs5HZUoKkGZWTG1KKQc5AXKvbjaAMvXyD6/qpgdIt0pIxycdQFJbHTzoKKpsAETZvB4OpgBoJJd9ANpnUgCS+vd8eupzNj24BKDRASm6LgkD4nOQqvM7I0Cb08XCfe+O+QNii+U37y+pvTsqdR9izR/QPaNynRutmxdopJODyigi9u6ovQz2YYvBRaybP6P27qgki6Ah3265iMk0/wh6/HRWkHt3NG3xOxvC5lCMmo4NcBfLGSXrvTtSAVTxMdy7QxNB5p9CCDxr2DegaveX3KgfpMlB5p9j0c6rRpmDJFL4jxMQYZs3oPahEwCkyUEWHxWzyEGc1ykAUldtAcjibACIMM0IkN2OGcamqeUgm6q3kuabmPqeIwOS37EA6DYhQH7jgvkD8u32zj4HxTUu6MElAMWdg6xt0wMU1dn04BKAAMjPJQABkJ9LAAIgP5cABEB+Lh0BpaepRxDxcDD5S4x6vAxAAKQ3ARBlQg4ayyUAAZCfSwACID+XAARAfi4BqPfRvGpZQlTF/KsDIKIYABHFAIgohhlFQgBECIAIARAhACLkCIhbI2Uo2TJzI3X/o7JZqcXbS/tyZSuPlq1iboD4teJmki4zN9J6kTvUeJ2z9ba25Vgr1+1iboD4dZpmki4zN9Hmw5fcvkZWwKGl2yW6n5dNMTdA/Epfc3HLzA31/P1n+XZaF9t8/MEuMdtydQQ1xdwA8WvFjdVdZm6g9RmLd+tibMlteZrW5ark0xQbMoIky8yNqnp2i6Abl4Ats2Rxf7T0jSCXHCRdZk6rWlt8Zp+Dvm5P0bZcHTq+OYhfK24m6TJzw9pyh2LXeRV9duXqCGqKDdcPki4zN5JbP6gswHVoDHW/4LtP6EkTAiBCAEQIgAgBECEAIgRAhACIEAARAiBCUQL68+a/11l2+Kf8dlIUT+dZ9vJX9fNg8LbECej1q9/FKmPfXv56Oi+prF79Zj8fjk+GbkukgE523958u2PRU5IpX47RljgBMRa7b6vth8Wzwy2o4TUBQOWVxgRAjThAdy++NX8cXvEDejovQ6ikxJL0NmEPq/gBbW/vLIpwm49SAEQIgAgBECEAIgRAhACIEAARAiBCAETof4TneMzE1ryhAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>vec,<span class="dt">y=</span>alg))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>vec,<span class="dt">y=</span>ana))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>vec,<span class="dt">y=</span>sta))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>alg,<span class="dt">y=</span>ana))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>alg,<span class="dt">y=</span>sta))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkGaQtpCQ27aQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///8AkkNUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJOUlEQVR4nO2dAVfbNhSFTcu6kdIFujZd27CutIWSNBBYAuj//7FZsZ3I1pOfZUu2bN97eg4kvn6WP6QnyYnUSEClirouQOgCIEYAxAiAGAEQIwBiZAnozqyyY24M/q+gGACIMQAQYwAgxgBAjAGAGAMAMQYAYgw9BBRFUa0AynmCCaJaewcoilhCZAD1PFEeJGflAW3OJ6cLIR4/TN7cApCux7+vxOrN7fPlXKz+BCCiAr2/FY8fF/E/sflr0T2g4HJQWoN2nOJfhfgtltE9WJXkoCT53L/JAElZ//lcGgLr5jdvr8T96eJQgwAor7TqhJODQgOU1qDny1kYvVhwgMT9ZPL6KpxxUHiAKHVafADyHQCAHBoAiDEAEGMAIMYAQIwBgBgDADEGAGIMAMQYAIgxABBjGCKgig+ty2yDBlTxY49SGwABEBthvICQg9CL+Q4AQA4NAMQYhgUozbsAZFDWcwcAKEztAPmKbWd389epaehDDXJz8ZoG5CDfAQYLyLqCJCfoc4qBArJOMckJxKwUgNQTAIgIsG9bowJUPQdlTEaWg6oH4J6ZARAAMQbmoSIAuTMAEGMAIMYAQIyhb4Bk9kWSNh9KHomxAcbbzQMQY7AHFFGwhgvIOgdFEUVowIBsAwCQ2bDDAkBGQ8plbDmoeoCynmyogIgHZiSEsQIiHrnSFJQc1LgIFQA9XwayZtUSkJsiVAB0M5dLwwPYuyNQQHLBfPqj63XzVjnIURF4QJv332UTw94dJm3O55IO9u4wAkqqDvbuMOnxM/buKAUke7G4+mDvDnMV+hDUHmbhAaLUafEByHcAAHJoACDGMC5A2cQEgGjtp7YARAuAGAMAcQbkIPeGIQJivtphV4QBAuK+uWBXBABiDL0GdAChIgGg7PiBRJ4JclD60wQIvVj6E4C443QOAiAMFPnjRB5W3gIgoidX3wKg0QPivuU8dkDMWLgPOcivdoC6LkRBIdSg/eMsvgbVvEINQ0CAlAeiXA6qeYU6hjAB1QvgxQBAjIEE9PBqV9gXP1sFVPmReueAni5Oni7OttOzdmtQJUNUbbWPOwMFSKK5PhHrl7+CA5QMAHxeoWgwAVoei3XbTayCIQxA4npHZxlUDYoO+7kI5Q3vRSABxUlIXEdHX4182geUdXH7HFQ2mBxoN19q0OaiXQJK+6+gcpBSg5Rf6POjMni2RegLIDUHHRobKcXjoAg6oGV2geg4oCaWqsLNewe0r0FlcnPxyob97fI3v//zjmljAeV+nfBpDCiuQttp2VSsO0BcAOcjSRJQPFBcxgPFYHJQaIDiCvR0EdJUwwKQ89msAdB2etJTQK4NFKB4prGO5xnXrTWxQkoNHpB8YHYsrkvmqm4BFTsdjmD3gHg5LR0PqOkVGhj6Achw3DTaGRqgujnIOB5sHZDcdaHLJZnBA1pN5sLl1hTUfSnvGQFF+4+Fov3WQHfE9KNtQJt3n+Yut6ag/vLqe6Y2mHmyb3ekr/XJV8uAnr/9uJy73JoimQ7w75nPS35LX2eAGpWJVUn41Uw2L4dbU2g1qFAHChHyM/m74GrQblMBtQY1BlTMQcU7zEdQDhVyUPa64xy0mkjNPG5NUX5/esYKb6Aoa5DHrSmGAcjnOKh8oKh1eeEB0tVS6bq6Qo8BRerzMK1uHbK4syL0DFAy4FFfaEcdFwGAGEMfARUHjsRI0l0RegZII3RnGEk6K0LfAJU0LD9FGAqgsqmG1tkNGxDZuZdNVvUaNnBA9FAcgBJpzenwrinAqADpz37275sDjCkHmQD5K0KYgAoDwLu73JhHfZ+ENXhACYMcCWXUXOBDEBozoEIAAMreU+ddNCDFPHhATA5SA2gTVVdF2P8WJCCjNED5Ix6K0EdAWfMzTllHDEj5mi9ByEcR+gYoj6iFIgQIqHjjVFsaM6DinZNtqXzCEQAgj0o6KvPrjhR4DdJHRA2u0PMmRuUg06TDVxHCBqQbAIgxABBnQA6yMvi/AgBVNwAQYwAgxtAbQJ4m66yhL4B8Pe5hDQDEGEIGpA54SECmEdFIAOWHzEQOMo6pRwmICABAVQCN8qPn9CebYkyExgKownEAYo4DEHd81Dmouyv0BFAb40DWEDCgVoY5rAGAGENXgMoeLAMQ89FE33LQ5nwycb1mtdFH64EBkovlN2+vTHt3aDc6OkD3ksrN3LBuXr9TZzmo9vEOclBciwx7dwTy3Qv/YtbNz0x7d9StQZosHsoHV4MeP8yEce+OejlIk80z59AAbc7nkpK/vTukegwo4eNz7w4pClCUfNfO0RVqGnhAye4vc997mOk5KMrk6Ar1DBWaGKU2SgdAhHY4SED46Fkq4UHlIHyyulMekH6k+RWsDQDEGMIClMtBxBEHV7A1BAGo0FP1bKDoH1CxLweggkYHqOxZD1W6sQEqfVpIlm5kOcgekKUBgBoeDx2QdQ6yNfQekO/iA5DvAADk0ABAjAGAGAMAMQYAYgwAxBgAiDHUBDQ+hVCDsinKEGqQj9LtJ7kARAuAGAMAcQbkIEcGAPIdAIAcGgCIMQAQYwAgxgBAjAGAGENNQCVq9l+MOongowgAxEQAICYCADER8ESREQAxAiBGAMQIgBi5AEStH7eV/r8mW54+eX3VqAjxTZwuiAgOAJHrx221msxFgwg3c7m4tkEAeRMrKoIDQOT6cUtt3n2ai/oR5JmiuHzUrgByae7HhR7BUQ7KrR+31/O3H/Gfrn6Ezfvvsok1KEJag/QIbgDp68fttJrJul0/glxfG99bkyIkyUeP4AQQsX7cSvGpzw1r0G3DShwnUXF/uvBTg6j141ZK1g/PGuSgz7v7alCEtOp4yUHk+nFbyRrUIMLNPKmGtQOkNUiP4AAQuX7cVg3HQfGZ5Cimuu4n9EgKI2lGAMQIgBgBECMAYgRAjACIUfiAHn7/2uXlAYgRADEKGNDDqyiKTnaAttPo6MsfP7soRbiAttMzIZYvfsaAttOT+OULAMrpv19i177if2vJZglARa3jJnYkAS1fxrAe0MTy2k6PvqY1CIAorSWV9dG+ia3RxPJaywr0agcISZrUdZyB/p2eZd38PwBUrl2Ta1+9ACRb29PFcSfX7gUgsYw7/G749ARQhwIgRgDECIAYARAjAGIEQIz+B7sloRJHnxcVAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>scor,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>ana,<span class="dt">y=</span>sta))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cor</span>(scor))</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mec</th>
<th align="right">vec</th>
<th align="right">alg</th>
<th align="right">ana</th>
<th align="right">sta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mec</td>
<td align="right">1.0000000</td>
<td align="right">0.5534052</td>
<td align="right">0.5467511</td>
<td align="right">0.4093920</td>
<td align="right">0.3890993</td>
</tr>
<tr class="even">
<td>vec</td>
<td align="right">0.5534052</td>
<td align="right">1.0000000</td>
<td align="right">0.6096447</td>
<td align="right">0.4850813</td>
<td align="right">0.4364487</td>
</tr>
<tr class="odd">
<td>alg</td>
<td align="right">0.5467511</td>
<td align="right">0.6096447</td>
<td align="right">1.0000000</td>
<td align="right">0.7108059</td>
<td align="right">0.6647357</td>
</tr>
<tr class="even">
<td>ana</td>
<td align="right">0.4093920</td>
<td align="right">0.4850813</td>
<td align="right">0.7108059</td>
<td align="right">1.0000000</td>
<td align="right">0.6071743</td>
</tr>
<tr class="odd">
<td>sta</td>
<td align="right">0.3890993</td>
<td align="right">0.4364487</td>
<td align="right">0.6647357</td>
<td align="right">0.6071743</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corrplot</span>(<span class="kw">cor</span>(scor))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that in graph ‘ana<sub>alg’,’alg</sub>vec’,‘ana<sub>sta’,’alg</sub>sta’, the points are placed in a way that seems have a bigger correlation. In the correlation matrix, those pairs have bigger correlation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#bootstrap</span>
<span class="kw">library</span>(boot)
r_<span class="dv">12</span> =<span class="st"> </span><span class="cf">function</span>(x,i){
  <span class="kw">return</span>(<span class="kw">cor</span>(x<span class="op">$</span>mec[i],x<span class="op">$</span>vec[i]))
}
r_<span class="dv">34</span> =<span class="st"> </span><span class="cf">function</span>(x,i){
  <span class="kw">return</span>(<span class="kw">cor</span>(x<span class="op">$</span>alg[i],x<span class="op">$</span>ana[i]))
}
r_<span class="dv">35</span> =<span class="st"> </span><span class="cf">function</span>(x,i){
  <span class="kw">return</span>(<span class="kw">cor</span>(x<span class="op">$</span>alg[i],x<span class="op">$</span>sta[i]))
}
r_<span class="dv">45</span> =<span class="st"> </span><span class="cf">function</span>(x,i){
  <span class="kw">return</span>(<span class="kw">cor</span>(x<span class="op">$</span>ana[i],x<span class="op">$</span>sta[i]))
}
result_<span class="dv">12</span> =<span class="st"> </span><span class="kw">boot</span>(scor,r_<span class="dv">12</span>,<span class="dv">1000</span>)
result_<span class="dv">34</span> =<span class="st"> </span><span class="kw">boot</span>(scor,r_<span class="dv">34</span>,<span class="dv">1000</span>)
result_<span class="dv">35</span> =<span class="st"> </span><span class="kw">boot</span>(scor,r_<span class="dv">35</span>,<span class="dv">1000</span>)
result_<span class="dv">45</span> =<span class="st"> </span><span class="kw">boot</span>(scor,r_<span class="dv">45</span>,<span class="dv">1000</span>)
result =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sd</span>(result_<span class="dv">12</span><span class="op">$</span>t),<span class="kw">sd</span>(result_<span class="dv">34</span><span class="op">$</span>t),<span class="kw">sd</span>(result_<span class="dv">35</span><span class="op">$</span>t),<span class="kw">sd</span>(result_<span class="dv">45</span><span class="op">$</span>t))
<span class="kw">names</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'12'</span>,<span class="st">'34'</span>,<span class="st">'35'</span>,<span class="st">'45'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td align="right">0.0779569</td>
</tr>
<tr class="even">
<td>34</td>
<td align="right">0.0486264</td>
</tr>
<tr class="odd">
<td>35</td>
<td align="right">0.0593826</td>
</tr>
<tr class="even">
<td>45</td>
<td align="right">0.0690917</td>
</tr>
</tbody>
</table>
</div>
<div id="project-7.b" class="section level1">
<h1>Project 7.B</h1>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi_2(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_norm =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">50</span><span class="op">*</span><span class="dv">500</span>),<span class="dt">ncol=</span><span class="dv">50</span>,<span class="dt">nrow=</span><span class="dv">500</span>)
data_chisq =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rchisq</span>(<span class="dv">50</span><span class="op">*</span><span class="dv">500</span>,<span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">50</span>,<span class="dt">nrow=</span><span class="dv">500</span>)
interval_norm =<span class="st"> </span><span class="kw">list</span>()
interval_chisq =<span class="st"> </span><span class="kw">list</span>()
SK =<span class="st"> </span><span class="cf">function</span>(x,i){
  EX =<span class="st"> </span><span class="kw">mean</span>(x[i])
  EX2 =<span class="st"> </span><span class="kw">sum</span>((x[i] <span class="op">-</span><span class="st"> </span>EX)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">length</span>(i)
  EX3 =<span class="st"> </span><span class="kw">sum</span>((x[i] <span class="op">-</span><span class="st"> </span>EX)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="kw">length</span>(i)
  <span class="kw">return</span>(EX3<span class="op">/</span>EX2<span class="op">^</span><span class="fl">1.5</span>)
}
<span class="co">#do the boostrap to estimate sd.</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){
  bnorm =<span class="st"> </span><span class="kw">boot</span>(data_norm[i,],SK,<span class="dv">500</span>)
  bchisq =<span class="st"> </span><span class="kw">boot</span>(data_chisq[i,],SK,<span class="dv">500</span>)
  interval_norm[[i]] =<span class="st"> </span><span class="kw">c</span>(<span class="kw">boot.ci</span>(bnorm,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'norm'</span>),<span class="kw">boot.ci</span>(bnorm,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'basic'</span>),<span class="kw">boot.ci</span>(bnorm,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'perc'</span>))
    interval_chisq[[i]] =<span class="st"> </span><span class="kw">c</span>(<span class="kw">boot.ci</span>(bchisq,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'norm'</span>),<span class="kw">boot.ci</span>(bchisq,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'basic'</span>),<span class="kw">boot.ci</span>(bchisq,<span class="dt">conf =</span> <span class="fl">0.95</span>,<span class="dt">type =</span> <span class="st">'perc'</span>))
}
real_norm =<span class="st"> </span><span class="dv">0</span>
real_chisq =<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)
<span class="co"># two functions that compute the samples in the intervals and fall in the left/right of the interval</span>
get_in_norm =<span class="st"> </span><span class="cf">function</span>(x){
  in_normal =<span class="st"> </span>(x<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(x<span class="op">$</span>normal[<span class="dv">3</span>]<span class="op">&gt;</span><span class="dv">0</span>)
  left_normal =<span class="st"> </span>x<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">0</span>
  right_normal =<span class="st"> </span>x<span class="op">$</span>normal[<span class="dv">3</span>]<span class="op">&lt;</span><span class="dv">0</span>
  in_basic =<span class="st"> </span>(x<span class="op">$</span>basic[<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(x<span class="op">$</span>basic[<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>)
  left_basic =<span class="st"> </span>x<span class="op">$</span>basic[<span class="dv">4</span>]<span class="op">&gt;</span><span class="dv">0</span>
  right_basic =<span class="st"> </span>x<span class="op">$</span>basic[<span class="dv">5</span>]<span class="op">&lt;</span><span class="dv">0</span>
  in_perc =<span class="st"> </span>(x<span class="op">$</span>perc[<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(x<span class="op">$</span>perc[<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>)
  left_perc =<span class="st"> </span>x<span class="op">$</span>perc[<span class="dv">4</span>]<span class="op">&gt;</span><span class="dv">0</span>
  right_perc =<span class="st"> </span>x<span class="op">$</span>perc[<span class="dv">5</span>]<span class="op">&lt;</span><span class="dv">0</span>
  <span class="kw">return</span>(<span class="kw">c</span>(in_normal,left_normal, right_normal,in_basic,left_basic,right_basic,in_perc,left_perc,right_perc))
}
get_in_chisq =<span class="st"> </span><span class="cf">function</span>(x){
  in_normal =<span class="st"> </span>(x<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&lt;</span>real_chisq)<span class="op">&amp;</span>(x<span class="op">$</span>normal[<span class="dv">3</span>]<span class="op">&gt;</span>real_chisq)
  left_normal =<span class="st"> </span>x<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&gt;</span>real_chisq
  right_normal =<span class="st"> </span>x<span class="op">$</span>normal[<span class="dv">3</span>]<span class="op">&lt;</span>real_chisq
  in_basic =<span class="st"> </span>(x<span class="op">$</span>basic[<span class="dv">4</span>]<span class="op">&lt;</span>real_chisq)<span class="op">&amp;</span>(x<span class="op">$</span>basic[<span class="dv">5</span>]<span class="op">&gt;</span>real_chisq)
  left_basic =<span class="st"> </span>x<span class="op">$</span>basic[<span class="dv">4</span>]<span class="op">&gt;</span>real_chisq
  right_basic =<span class="st"> </span>x<span class="op">$</span>basic[<span class="dv">5</span>]<span class="op">&lt;</span>real_chisq
  in_perc =<span class="st"> </span>(x<span class="op">$</span>perc[<span class="dv">4</span>]<span class="op">&lt;</span>real_chisq)<span class="op">&amp;</span>(x<span class="op">$</span>perc[<span class="dv">5</span>]<span class="op">&gt;</span>real_chisq)
  left_perc =<span class="st"> </span>x<span class="op">$</span>perc[<span class="dv">4</span>]<span class="op">&gt;</span>real_chisq
  right_perc =<span class="st"> </span>x<span class="op">$</span>perc[<span class="dv">5</span>]<span class="op">&lt;</span>real_chisq
  <span class="kw">return</span>(<span class="kw">c</span>(in_normal,left_normal, right_normal,in_basic,left_basic,right_basic,in_perc,left_perc,right_perc))
}
percent_normal =<span class="st"> </span><span class="kw">sapply</span>(interval_norm, get_in_norm)
percent_chisq =<span class="st"> </span><span class="kw">sapply</span>(interval_chisq, get_in_chisq)
result =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">9</span>,<span class="dt">nrow =</span> <span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){
  result[<span class="dv">1</span>,i] =<span class="st"> </span><span class="kw">mean</span>(percent_normal[i,])
  result[<span class="dv">2</span>,i] =<span class="st"> </span><span class="kw">mean</span>(percent_chisq[i,])
}
<span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'in_normal'</span>,<span class="st">'left_normal'</span>,<span class="st">'right_normal'</span>,
   <span class="st">'in_basic'</span>,<span class="st">'left_basic'</span>,<span class="st">'right_basic'</span>,
   <span class="st">'in_perc'</span>,<span class="st">'left_perc'</span>,<span class="st">'right_perc'</span>)
<span class="kw">rownames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'norm'</span>,<span class="st">'chisq5'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">in_normal</th>
<th align="right">left_normal</th>
<th align="right">right_normal</th>
<th align="right">in_basic</th>
<th align="right">left_basic</th>
<th align="right">right_basic</th>
<th align="right">in_perc</th>
<th align="right">left_perc</th>
<th align="right">right_perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>norm</td>
<td align="right">0.894</td>
<td align="right">0.052</td>
<td align="right">0.054</td>
<td align="right">0.886</td>
<td align="right">0.052</td>
<td align="right">0.062</td>
<td align="right">0.942</td>
<td align="right">0.032</td>
<td align="right">0.026</td>
</tr>
<tr class="even">
<td>chisq5</td>
<td align="right">0.756</td>
<td align="right">0.028</td>
<td align="right">0.216</td>
<td align="right">0.722</td>
<td align="right">0.050</td>
<td align="right">0.228</td>
<td align="right">0.748</td>
<td align="right">0.000</td>
<td align="right">0.252</td>
</tr>
</tbody>
</table>
<p>Comparing the results of <span class="math inline">\(\chi_2(5)\)</span> and normal distribution, we can find that in normal distribution, the proportion of samples that estimated interval contains true values is higher than <span class="math inline">\(\chi_2(5)\)</span>. Also, fot <span class="math inline">\(\chi_2(5)\)</span> distribution, most of the intervals that don’t contains true value fall into the right of the interval.</p>
</div>
<div id="section-14" class="section level1">
<h1>11-15</h1>
</div>
<div id="question7.8" class="section level1">
<h1>Question7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
</div>
<div id="answer-7.8" class="section level1">
<h1>Answer 7.8</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
<span class="kw">library</span>(boot)
<span class="kw">data</span>(scor)
Length =<span class="st"> </span><span class="kw">nrow</span>(scor)
<span class="co">#compute the estiate theta-hat.since cov function in R have been adjusted, I use (n-1)/n*cov as the MLE of covariance matrix estimation</span>
Sigma_hat =<span class="st"> </span><span class="kw">cov</span>(scor)<span class="op">*</span>(Length<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>Length
EIGEN =<span class="st"> </span><span class="kw">eigen</span>(Sigma_hat)
theta_hat =<span class="st"> </span>EIGEN<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(EIGEN<span class="op">$</span>values)
<span class="co">#do the jacknife </span>
JACK =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length=</span>Length)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Length){
  Sigma_hat =<span class="st"> </span><span class="kw">cov</span>(scor[<span class="op">-</span>i,])<span class="op">*</span>(Length<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(Length<span class="op">-</span><span class="dv">1</span>)
  EIGEN =<span class="st"> </span><span class="kw">eigen</span>(Sigma_hat)
  JACK[i] =<span class="st"> </span>EIGEN<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(EIGEN<span class="op">$</span>values)
}
BIAS =<span class="st"> </span>(<span class="kw">mean</span>(JACK)<span class="op">-</span>theta_hat)<span class="op">*</span>(Length<span class="op">-</span><span class="dv">1</span>)
SE =<span class="st"> </span><span class="kw">sqrt</span>((Length<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(Length)<span class="op">*</span><span class="kw">sum</span>((JACK<span class="op">-</span><span class="kw">mean</span>(JACK))<span class="op">^</span><span class="dv">2</span>))
##########################################################
<span class="co">#Another solution using jacknife function in boot package </span>
SCOR =<span class="st"> </span><span class="kw">as.matrix</span>(scor)
est =<span class="st"> </span><span class="cf">function</span>(X){
  Sigma_hat =<span class="st"> </span><span class="kw">cov</span>(SCOR[X,])<span class="op">*</span>(Length<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>(Length<span class="op">-</span><span class="dv">1</span>)
  EIGEN =<span class="st"> </span><span class="kw">eigen</span>(Sigma_hat)
  return =<span class="st"> </span>EIGEN<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(EIGEN<span class="op">$</span>values)
}
RESULT =<span class="st"> </span><span class="kw">jackknife</span>(<span class="dv">1</span><span class="op">:</span>Length,est)

##########################################################

result =<span class="st"> </span><span class="kw">c</span>(theta_hat,BIAS,SE)
<span class="kw">names</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'theta_hat'</span>,<span class="st">'BIAS'</span>,<span class="st">'SE'</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(result)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>theta_hat</td>
<td align="right">0.6191150</td>
</tr>
<tr class="even">
<td>BIAS</td>
<td align="right">0.0010691</td>
</tr>
<tr class="odd">
<td>SE</td>
<td align="right">0.0495523</td>
</tr>
</tbody>
</table>
</div>
<div id="question-7.10" class="section level1">
<h1>Question 7.10</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)
<span class="kw">attach</span>(ironslag)
L10 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)
L20 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))
L30 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)
L40 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))
Length =<span class="st"> </span><span class="kw">nrow</span>(ironslag)
result =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">4</span>,<span class="dt">nrow =</span> Length)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Length){
  mag =<span class="st"> </span>magnetic[<span class="op">-</span>i]
  chem =<span class="st"> </span>chemical[<span class="op">-</span>i]
  L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mag <span class="op">~</span><span class="st"> </span>chem)
  L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(mag <span class="op">~</span><span class="st"> </span>chem <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chem<span class="op">^</span><span class="dv">2</span>))
  L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(mag) <span class="op">~</span><span class="st"> </span>chem)
  L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(mag <span class="op">~</span><span class="st"> </span>chem <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chem<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chem<span class="op">^</span><span class="dv">3</span>))
  result[i,<span class="dv">1</span>] =<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(L1,<span class="kw">data.frame</span>(<span class="dt">chem=</span>chemical[i])) 
  result[i,<span class="dv">2</span>] =<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(L2,<span class="kw">data.frame</span>(<span class="dt">chem=</span>chemical[i])) 
  result[i,<span class="dv">3</span>] =<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">predict</span>(L3,<span class="kw">data.frame</span>(<span class="dt">chem=</span>chemical[i])))
  result[i,<span class="dv">4</span>] =<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(L4,<span class="kw">data.frame</span>(<span class="dt">chem=</span>chemical[i])) 
}
CR =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(result[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(result[,<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(result[,<span class="dv">3</span>]<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(result[,<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>))
R_square =<span class="st"> </span><span class="kw">c</span>(<span class="kw">summary</span>(L10)<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(L20)<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(L30)<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(L40)<span class="op">$</span>adj.r.squared)
<span class="kw">names</span>(CR) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'LM'</span>,<span class="st">'quadratic'</span>,<span class="st">'exp'</span>,<span class="st">'cubic'</span>)
<span class="kw">names</span>(R_square) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'LM'</span>,<span class="st">'quadratic'</span>,<span class="st">'exp'</span>,<span class="st">'cubic'</span>)</code></pre></div>
<p>According to the errors below, we should choose model 2 (quadratic model)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(CR)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LM</td>
<td align="right">19.55644</td>
</tr>
<tr class="even">
<td>quadratic</td>
<td align="right">17.85248</td>
</tr>
<tr class="odd">
<td>exp</td>
<td align="right">18.44188</td>
</tr>
<tr class="even">
<td>cubic</td>
<td align="right">18.17756</td>
</tr>
</tbody>
</table>
<p>According to the adjusted-R square below, we should also choose model 2(quadratic model)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(R_square)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LM</td>
<td align="right">0.5281545</td>
</tr>
<tr class="even">
<td>quadratic</td>
<td align="right">0.5768151</td>
</tr>
<tr class="odd">
<td>exp</td>
<td align="right">0.5280556</td>
</tr>
<tr class="even">
<td>cubic</td>
<td align="right">0.5740396</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
MYdata =<span class="st"> </span>ironslag
MYdata<span class="op">$</span>L1 =<span class="st"> </span>L10<span class="op">$</span>fitted.values
MYdata<span class="op">$</span>L2 =<span class="st"> </span>L20<span class="op">$</span>fitted.values
MYdata<span class="op">$</span>L3 =<span class="st"> </span>L30<span class="op">$</span>fitted.values
MYdata<span class="op">$</span>L4 =<span class="st"> </span>L40<span class="op">$</span>fitted.values
<span class="kw">ggplot</span>(<span class="dt">data =</span> MYdata)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>chemical,<span class="dt">y=</span>magnetic)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>chemical,<span class="dt">y=</span>L1),<span class="dt">color=</span><span class="st">'red'</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>chemical,<span class="dt">y=</span>L2),<span class="dt">color=</span><span class="st">'yellow'</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>chemical,<span class="dt">y=</span><span class="kw">exp</span>(L3)),<span class="dt">color=</span><span class="st">'green'</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>chemical,<span class="dt">y=</span>L4),<span class="dt">color=</span><span class="st">'blue'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #11-22</p>
</div>
<div id="question-8.3" class="section level1">
<h1>QUESTION 8.3</h1>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-8.3" class="section level1">
<h1>Answer 8.3</h1>
<p>Suppose that we have <span class="math inline">\(H_0: \sigma_1^2 = \sigma_2^2\)</span>, then the count5 statistisc should have same distribution after permutation, so I compute the proportion of count5 of permutations that have more extreme values than the true value</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
n1 =<span class="st"> </span><span class="dv">20</span>
n2 =<span class="st"> </span><span class="dv">30</span>
m =<span class="st"> </span><span class="dv">1000</span>
result =<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{
  X =<span class="st"> </span><span class="kw">rnorm</span>(n1)
  Y =<span class="st"> </span><span class="kw">rnorm</span>(n2)
  L =<span class="st"> </span><span class="kw">c</span>(X,Y)
  x =<span class="st"> </span>X<span class="op">-</span><span class="kw">mean</span>(X)
  y =<span class="st"> </span>Y<span class="op">-</span><span class="kw">mean</span>(Y)
  L =<span class="st"> </span><span class="kw">c</span>(x,y)
  count5 =<span class="st"> </span><span class="kw">max</span>(<span class="kw">sum</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y)),<span class="kw">sum</span>(y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x)))
  temp =<span class="st"> </span><span class="kw">numeric</span>(<span class="dt">length =</span> <span class="dv">999</span>)
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">999</span>){
    permu =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2),n1<span class="op">+</span>n2)
    X2 =<span class="st"> </span>L[permu[<span class="dv">1</span><span class="op">:</span>n1]]
    Y2 =<span class="st"> </span>L[permu[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n1<span class="op">+</span>n2)]]
    x =<span class="st"> </span>X2 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X2)
    y =<span class="st"> </span>Y2 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Y2)
    temp[i] =<span class="st"> </span><span class="kw">max</span>(<span class="kw">sum</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y)),<span class="kw">sum</span>(y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x)))
  }
  <span class="kw">sum</span>(count5<span class="op">&gt;</span>temp)
})
pt =<span class="st"> </span><span class="kw">as.data.frame</span>(result<span class="op">/</span><span class="dv">1000</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> pt)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(result<span class="op">/</span><span class="dv">1000</span>,..density..),<span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">sum</span>(pt<span class="op">&lt;=</span><span class="fl">0.95</span>))</code></pre></div>
<pre><code>## [1] 968</code></pre>
</div>
<div id="question-2-1" class="section level1">
<h1>Question 2</h1>
<p>Power comparison (distance correlation test versus ballcovariance test) Model 1:Y=X/4+e Model 2:Y=X/4*e #Answer</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">library</span>(Ball)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(ggplot2)
N =<span class="st"> </span><span class="dv">100</span>
getpower =<span class="st"> </span><span class="cf">function</span>(N){
POWER =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol =</span> <span class="dv">4</span>,<span class="dt">nrow =</span> <span class="dv">100</span>)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){
X =<span class="st"> </span><span class="kw">mvrnorm</span>(N,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow =</span> T))
E =<span class="st"> </span><span class="kw">mvrnorm</span>(N,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow =</span> T))
Y1 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span><span class="op">+</span>E
Y2 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span><span class="op">*</span>E
POWER[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">bcov.test</span>(X,Y1,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value
POWER[i,<span class="dv">2</span>] =<span class="st"> </span><span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value
POWER[i,<span class="dv">3</span>] =<span class="st"> </span><span class="kw">dcor.test</span>(X,Y1,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value
POWER[i,<span class="dv">4</span>] =<span class="st"> </span><span class="kw">dcor.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value
  }
<span class="kw">return</span> (<span class="kw">colSums</span>(POWER<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span><span class="dv">100</span>)
}
POWER =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">nrow=</span><span class="dv">80</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">40</span>){
  POWER[i,] =<span class="st"> </span><span class="kw">getpower</span>(i)
}
DT =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">80</span>,POWER))
<span class="kw">colnames</span>(DT) =<span class="st"> </span><span class="kw">c</span>(<span class="st">'n'</span>,<span class="st">'B1'</span>,<span class="st">'B2'</span>,<span class="st">'D1'</span>,<span class="st">'D2'</span>)
<span class="co">#ball, Y1-X</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>DT) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(n,B1))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#distance, Y1-X</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>DT) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(n,D1))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ball,Y2-X</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>DT) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(n,B2))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQtpCQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T///9pG4jVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHAElEQVR4nO2di3bTRhgGVaCUAG2gJZQ2KdALkJQQgpvY7/9m1WWtiy15vJZkx/F85zSSPd5oNazlPU5/bTIzK5PsugN3PQqCKAiiIIiCIAqCbCzoKqTcWUwn2Bbp98sUBERBQBQEREFAFAREQUDWEjT5+SLf3rw+ev6l3ChonuujZ7mg6bvT2eWP802UoCRLvgk/5s/VHlQ/WrLw8pizHV3Q+dO/ixF08+YiG0xhEyOo5XyvOh5w7pyg8i02efVldvPrh7BJn/g+zap2ZZZOsvFc2wtWZK0jDp51BF0/z82ETWCDjKAYP/s0gtYWVLsGVefY6odlRZ/t9gRtfg2qUj/HWePJVrLU6k5+is11TN+dFJ9iJ9GfYmXur6DsvyHmQbU3yaz5ZCtZbHU3Ba3KyP0bgCho1A4oCIiCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoAoCEhvQYcSR1AHURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVlDUFncc3mU5TTfPtuwXmwHZGxBzSLnrB7z/NQRVB9A9QLDrBRz+v5DDY/cvwHI2IIaJarZUErfctkbbRZR9XwP0i2oXuScbycv66No5H/AAcg2R9B1WYpZXodG7t8AZJvXoPOT+bMKKlMrci7eWNkwmv7px3w1hPJ5UF71XLzT0nnQ0/KDbOT+DUCcSY/aAQUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURCQ3oIOJY6gDqIgIAoCoiAgCgKiICAKAqIgIAoCoiAgCgKiICAKAqIgIAoCoiAgCgLSIuhjkjz4lG6/5j8VtCjo48PPs6/JsYLC3qKg/346zn8+UlCx1y5odnv2SEH53qKg/C2Wi0oUdNV+kf7ubTGGgqBqxb5QzetSxo3UinqLIrFNljLeJRlbUFVQF+owey0jugMyxjzoybfHSfKoeFiVZIZq3g2WMr4HaVykb8/SedDt2ZP8cVXUG6p5N1jKeKdk4BF0ezafI34tPs6aKxen16FNljLeJRljHlQIKj7FmpecVNCBX4OWBFVFvaGat9dSxjsgYwuqFfWGat7DngctC1qdkfs3ABlcULl0t4Ku1pkoKkhBq4iCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoD0FnQocQR1EAUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURAQBQFREBAFAVEQEAUBURAQBQFREJA1BFXFPZMX+QKrLmXcSFXknJUZZmWZLmXcHEBlgeF1pun81KWMm2mWqKZ7LmXcTKPIOSvHdCnjZuoj6Ob1fKleV+otUytynrwoL88KKlMVOQc/LmW8OITmVc/Z/Ce7PLuUcUxG7t8AREGjdkBBQBQEREFAFAREQUAUBERBQBQEREFAFAREQUAUBERBQBQEREFAFAREQUAUBERBQHoLOpQ4gjqIgoAoCIiCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoAoCIiCgCgIiIKAKAiIgoAoCMhuBCVJUpHiwYDnNOgvW0NQVdQb9nov4Zcv7zYn4cGA5zToL2NBVVFv2OtYyjhZlfwlpYjwZJugxthq6/nKwwyY9QVVBXVhr30ZUT5eddxGJxrdCQ+6BY1jo6PH6wmqSjLDXvtSxnC4+SsaLy4fzBq/pbMrfJgBs3jgzi5VRb1hr30pYzhcx1BpHSD3ZwTVBcVcg8ID/Hxryf5egw53HlQV9Ya9A1/KuGUIlUsZDzUP2i7Zx5n0VomCRu2AgoAoCIiCgPQWNM8GNxLa5N5DOzuMgqCNgqCNgqCN/yM5REEQBUEUBFEQpJ+gxhcgayTcFDayWfbnlKg203f5zdaiDpN2LbtP7VKbXoKafwjihJvCxja7TKVGtTk/zb5Hj2qSde2yrU0vQc0vYTnhprCRzSa//HYadajstbG9y79wf3Ox3KaXoObX+Otl6dt/yvT9P+k/a0ybyau/srdY1GHCCFpu00tQ8w9BayX7Yjuu2eVJNu5j2mQ3xkzPNO4wxcVnuc2WR1B+U9ioZumLp9EjqOXPVNTm5YfZ9bOLgUdQ7DUo3PQ0qllxG9CTqGvQ7/lZRh0mDJ2Br0HNPwRxwk1hY5tlIyiqzflpMfAimoQRtNxmq/Og+U1hx54Hpa9tndOsyvVR+9zJmTREQRAFQRQEURBEQRAFQRQEURBEQZC9EPTthz8eJ8nxTo69H4IeP/w8+/fBp10ce08EHWfD6O0ujr0fgjI3CuqOgiAKgigIoqA7HAVBFARREERBEAVBFARREERBEAVB/gdXtZ/S/a3ocwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#distance,Y2-x</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>DT) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(n,D2))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-15" class="section level1">
<h1>11-29</h1>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Since the Laplace distribution is <span class="math display">\[f(x) = \frac{1}{2\lambda}e^{-\frac{|x-\mu|}{\lambda}}\]</span></p>
<p>when <span class="math inline">\(\lambda=1\)</span>,<span class="math inline">\(\mu=0\)</span>, we have <span class="math display">\[f(x)=\frac{e^{-|x|}}{2}\]</span></p>
<p>So the acceptance rate from <span class="math inline">\(X_t\)</span> to <span class="math inline">\(Y\)</span> is <span class="math inline">\(\frac{f(Y)}{f(X)}\)</span>, which equals to <span class="math display">\[e^{-|Y|+|X_t|}\]</span></p>
</div>
</div>
<div id="sigma1" class="section level1">
<h1>Sigma=1:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">1</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.7031</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=1&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma2" class="section level1">
<h1>sigma=2:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">2</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.5254</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=2&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma5" class="section level1">
<h1>sigma=5:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">5</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.285</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=5&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma10" class="section level1">
<h1>sigma=10:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">10</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.1596</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=10&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see as the increase of <span class="math inline">\(\sigma\)</span>, the acceptance rate becomes lower. Since 0 is the center of Laplace distribution, we can’t see obvious difference of the converge rates.</p>
</div>
<div id="section-16" class="section level1">
<h1>12-06</h1>
<div id="question-9.4-1" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Since the Laplace distribution is <span class="math display">\[f(x) = \frac{1}{2\lambda}e^{-\frac{|x-\mu|}{\lambda}}\]</span></p>
<p>when <span class="math inline">\(\lambda=1\)</span>,<span class="math inline">\(\mu=0\)</span>, we have <span class="math display">\[f(x)=\frac{e^{-|x|}}{2}\]</span></p>
<p>So the acceptance rate from <span class="math inline">\(X_t\)</span> to <span class="math inline">\(Y\)</span> is <span class="math inline">\(\frac{f(Y)}{f(X)}\)</span>, which equals to <span class="math display">\[e^{-|Y|+|X_t|}\]</span></p>
</div>
</div>
<div id="sigma1-1" class="section level1">
<h1>Sigma=1:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">1</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.7156</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=1&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA/FBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOmZmkJBmkNtmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZgCQZjqQZmaQkLaQtpCQttuQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2kDq2tpC2ttu229u22/+2///Ijk3I///bkDrbtmbbtpDb27bb29vb/7bb/9vb///kq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///+Hk34PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMo0lEQVR4nO3dC3/bthEA8HPSaN6r2+yuU7utXrdks/aqu63utsZVu7VuoHiRFX7/7zKCJIgDCPAA8C3d5ZdE4gEE+BdAUrQlQsbRGjB1B+YeDEQEAxHBQEQwEBEMRAQDEcFARHQCOmye3cu/1uKHX77sstZ5xRBA2ycMVAYDeeKrHwKc/doGOvwpX/pRvhAALrLsfx8C/PiLLNuvL3bn8M6NLrGoSAHaQhFXJlABky+tgB7O5bOzmxzo3fPykSrR7xYMHAlAh82TfGA8nK9MoIfzn94XS4spdtjIofJ1/nS/htX94XNYoRILirR90H//+edzaAA9/dW/i0cS6OH8onq4XxcFbp+81CUWFClA5eyxgbJbufAnX5RAu3Ia5jNrvy6GzDafY3WJBUUCUD5n3v3Lv75Z20DZ1/luGXIcL1BdYkGRAPRwfpU59kFF/OeP+T64nGJqX1xOsXzH9VKXWFAkAa3u5UG8xKmBdvCz++zweT5QtsUR6+yT/FC/kfugPFHspHWJBUXSUaycPRZQtTh/tpWH+WqOXeQj6Ol5ObF0iQVFyk5angK+80l+WHKcKOYH8mz/YX5gzx7yUk8/klNslZ8oFrvmusSCYvh389VOeqnBQEQwEBEMRARfUSSCgYhgICIYiAgGIiIBSNSBHtrhT02fCarEQESGgYgMAxEZBiIyDERkGIjIMBCRYSAiw0BEhoFwQDPDQDgYiEgxEJFiICLFQESKgYgUAxEpBiJSDESkGIhIMRCRYiAixUBEql+gI4wWBR5BMniKESkGIlIMRKQYiEgxEJFiICLFQESKgYgUAxEpBiJSDESkGIhIMRCRmikQeDPtawNvJmxtDERk5gYEvgwDNbdHMFAzxUBEHxiI6AMDEX2wHMCXCNlYsOstGwjM1q3OHBPQd5eXlz//koG8cXftHkH2Jlp9GBgIwuoEpLoCvf3bZwzUFo8v8ilWDKLv5YESRG1wFaqfQsL+D/AaIuoHdTSlZhlvPv4MjSL0SkDjJTBeivYRBHa6ywhqjmVjbeBPGekuR7F6P4QaYqARgWDBQK/ff5W9/bvjML88IGikjHSH86D36gMZ6gMDuQL1oRcgUMv7BkLLThsIXB2YJRDqUaY33QYC88FJA4G1tHhqAMG4QLAwIGCgZt9bgJpbafebgdwxOJDKzxNIVT5GILVt8o9uRkQAQU9AjhONZQCBPboSgMACAv3kxIA8QosGgkoCA0HvQMZaOgI5zicmBkJMePO6AgEDpQGBDQTzAoKuQGgCjQBkTNoBgWAUIFgeEHQBgq5AYANBKxD4gepKIwFBZyDoBgQVEJBAah8xOhAMAwTRQEABwYyAUCkTCFxA9RzxApXt1EAwCyAUcuuq/0D9qFQ+qP4pF4JekqFSZaXq36oA+sFpWUt1EqqfqaJixROoFqmqoOqD/lsWUo3Wa1X/Vb3wbmK8SuQI0ufT5skAHkFgjSDwjiCwRxCEjCDQI0jNy/pYUPViuinWDxA0gEABQSuQuZszger+zQ8IIoDAAgIKCGogwEBAAcFJAcGMgQD3ywcECKhCcgLBWEAwJhD4gfTSNiBwAYEfCGggsIFQ/8YDAicQoFcvEAi8QBAOBD4gGBMIAoBgbCCwgUAYfUgE2q+v9mvyHoRJQIAXu4CAAgIDSNXO0ErN/VsrUN2FGghCgG5X8v6EW+JmRd2BwAsEbiC1ARYQYCAggYAEgnagfAAdNqtsRwwhDxCkAOFQ4yAeSC1EW6szdlstQEAD7dcXXYDQZvQPBGlA7obMTgcCHTYXO3m72LQpVrdlTJtYIDCBwACyiloMwwPJW/CuslvqLpYxQOAG8vYbA9U4LXVMIKMFPxAqHAkUFg0gaLRlb7X/uatGP0BkM3bpwYHa+uF93laHwpExMtAW4GobPcVCNtb3nKoTuLmoaByQFdR50LNvyiP9koE6RcBh/ir6MB/V65kDweKAImJ4oGwrp5g8V+wPKKmTw6w2rO32nXRxi2/CZ3igKSPxMP/44vL9VwzkjbefXmff/eLEgcprQUU0dtKPf/gye/Nb18ehjiTQG6KkEfTmd6+yx9/Lz0OZn1mdcJPs6NYXXbux7ea7+Ss3kPxAXQlkjqCuW2VHhxV260vgCJInQcQIOm2gzPc2zLcP6tSp1n6OWRUiRlBZqLGTfvvp81GOYiHXQjxPxxlB3uh2HhTceX9BzzWn2QAZ4QYiLxVG9dOuNBegpOtBZA+JgeHeyh6BYmZuO1DC9aB6EyOB0NW/5QClXO7oCiTwlcDBgFoum5uvUf8XzNqBvFeJ1S9wWEDCrmo/mxYo5XpQMJBZhgASyUDu0drMCuNBKFDC9SCBNjcJqP6tHwPI/mnhXICCIhBIi3QFEgQQXvVRAYnuQPaqnW9/QoEEAbQ9uynebcRMMeEGEkADCQ+QiAQSPiBk0AuQ/L0FeQ4UtZNWQMIBZP4mjDZTAkKIECBhA2GDFCDz9RK6djvQYXMhf3vhyv+ePhxI9A2UCV2otggC0k3qRcb4DgYqLgbJURR1HuQDEg4g0QkI1cUvggdIgLE2ZaV3CEItQFwBQMXgmQ9QnTGB0CsvjKJOIIGBatV4IHm9tXwbRv2CkB9I96NfIBEKJPTvXkUAiSAgOXqKXdAOPBdeQ4AEiEQgYfV/MCCRCpTdyiP8YSN3Q/MEEiFAIglIMfV+otgOJPQsN4GEH0i0AYl0oEYDSmcioCwYSDSBzH2a8AFhYbXBOpk5gYTRkg00xPcHqdfNBhJNIPyyBQCJaCBRl6i2NQhI9A2EovxMavkIwPjkaVWgWlJ/zFR9eBV/U7Bahapb/oXqc61oVapsuRh9QhZ/7BQArV5/2jXDK0cffM2MBp2bGBuJIwg/b4wgQY8gXNYxgkTrCBJjjiAnEOqNC0j0B6QnWjqQMIHEDICE8dwGUjn7BW0FUitoB0LrFHrlUwGJAKAsAkiEAAkTSBwBkI5kIGMFQg3LCCCxDCBdEZeKAFLt9AAkBgISgwCJwYH0U/RgCiDRF5BzhUsCUm3jTbK3R7QACbCX16l4IOEDcjWklx0LkGgF0hkPULMLJw3UXPcJANnbOlcgEQ3k6t1JAdl9mAAId46BMly6kTkBILtOHJBwZxcH5NlE/fyIgZpb5QeyM8cC5OwEA6nVMdBSgOzwZ8YFcm7QyQGF3Wf1hIF891n1bdACgexMFJD3Pqu+DTo1IO99VgODuKOqL+v8QWe3HwXHR9iHen33WQ18kY56BN1dXpafNXTdRjSwD0cNpKUYyBve+6wG9oEA8mWWA+S9z2pgH44fyIj4PjAQ0QcGIvrAQEQfGIjoQ49A9mUfBrIzDISquTIMhKq5MgyEqrkyDISquTIMhKq5MgyEqrkyDISquTIMhKq5MgyEqrkyDISquTIMhKq5MgyEqrkyxwkU2zu7GgM5M0sFio/ERpzVZvmTVTPiX6QTG0HxfWAgog8MRPShTyCiTkiGgYgMAxGZowEaKsNARIaBiAwDERkGIjIMRGQYiMgwEJFhICLDQESGgYgMAxEZBiIyDERk5gc0swwDEZl+gYo70/nuL9atD1NlegV6LT/M673Parc+TJXpE+juvX/kI8h7n9VufZgq0/8U891n9RQiCMh3n9XTHkHVh1XNEcRAzhHE+yACyLzPqo6k3VFKpbHqOColnAf13of51EkBGqEP86nDQPGVxv6FrcUFAxHBQEQwEBEMREQ6kOfcyBVvflN8P1P1TWhVRaK+s3B7HVlFNhTTDj7Nc/6XDGReI2oN+TZOfkdT+QU7VUWqvqtwQJvyfXVEO/hyl7utZCDz/Vl7p2X/7q6r77CqKhL1nYXpNuVrEdGOcbnL3VYykPkOn4y8aPVNaFVFor6zMN2mfM2j2kEXK9xtJQOZ14iokG93q29CqyoS9Z2FyTaLZFw7+nKXu61xRtDji+fVo7vr4NHQLEzWeV3vjkPbGW4EReyD8qNY/UWVd9fB+5NmYbLO3XNfVW/XBtsH+a4RuTpR+lTfhFZVJOo7C1NtlrvnqHbQ5S53W2OcB6HzE/lNaMHnQc3CRJ1qKsW0M9x50KkEAxHBQEQwEBEMRAQDEcFARMwZ6LBZFf9vV9l+DfDk5RSdmDNQti1MDpur/Tqnun12P0EfZg308P0b+e8PXu7ObtSzsWPWQNntRVbMsCIYqBm7fFblM6x8wlOsGfsPbuQMKx5vz6YYQDMHknOsmmFbuJqkBzMH2j37tpxht9OMn9kD7T/4azHDttOcBGWzB8pufyRn2DQHsCLmDrQrdj1bKGKKvdDcgSYPBiKCgYhgICIYiAgGIoKBiGAgIhiICAYi4v/080SQxn+fLwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma2-1" class="section level1">
<h1>sigma=2:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">2</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.5337</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=2&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABTVBMVEUAAAAAADUAADoAAF4AAGYANYQAOjoAOmYAOpAAXqgAZpAAZrYzMzM1AAA1ADU1AF41hMk6AAA6ADo6AGY6OgA6Ojo6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjsheAABeADVeqOtmAABmOgBmkJBmkLZmkNtmtpBmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SENQCEyeuOTU2OTW6OTY6Obk2OyP+QOgCQZgCQZjqQZmaQkDqQkLaQtpCQttuQ2/+oXgCo6+urbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq2kDq2tpC2ttu225C229u22/+2///Ijk3I///JhDXJ6+vbkDrbtmbbtpDb27bb29vb/7bb///kq27k///rqF7ryYTr66jr68nr6+v/tmb/yI7/zAD/25D/27b/5Kv//7b//8j//9v//+T////6zoXnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALD0lEQVR4nO3d+WMbxRUH8KkJxakKjaAFaqWURvSI08MObaOe2IUWBD1yIdNiY2MrElaU/f9/7By7O7Or3X17zPEkve8PkeRnaUefzM6O5JGWRZTKsNANwB4CAkJAQAgICAEBISAgBASEgICgAlqOdk8b3uWL7zP2ykMnrVFZc6ApE9k5ctMeEVRAjbMc7XwQLT9jPXebQAG0/CPvBXeTHnTSZzs/G/WieX/vpL/z82jaZ2+JjnXC9yZ+M1oMmcqNR/xXolZ7Zv1gAFqO5PPdV890op69AHqzz0n+2pe3kp/vm0DJ/Te8B837b5/yf3oSaDHke803IwnE7kYnjO3xa7uny9GNh5H8rZVMuJqz4AD69k//I64IoCnbixSExFgMeaeK96H//fNP/YLh5sTlEIQCKBqLHeathxJiIg9JSzUGCSDx7Me7oovFu152F1t+yhyOQEiAoi/ek8+3CoizvPmXf305zAHx8WvPadNwAPH89w9sP7+LmUDz/n60OgbxEeuu23ZhAJqyH/Jx5rOdo/wgnQXqnUbfvJfbn8Yu54gyGIDiw7w4UmUP8yZQ/EtZoHhcSg/4DoIBSE0U3z41Joq/GK4M0rz3sFc+GGcsJmw7gFazGLodeusHHdC8/x3elcYu536Ngg4oHZBCNyQOOqB0QEISfEDIQkBACAgIAQEhICDNga6MZG6sJFTVykMTEFAlIKBKQECVgIAqAQFVAgKqBARUCQioEhBQRQ7ECAgAYh0emYAIiO9ilUIEtM5AXsLQNIx6UEmVgIAqbiB2RUAE1AloNiMgAKhSiIAIiIA6VQkIqBIQUCUgoEpAQJWAgCoBAVUCAqoEBFQbAB0z9vLn6urFq0zeuBwxdovfvjyUl+dqNf6dZs2qAfT8/cE7X8XXX3z4wCMQu6oN9PTlzy8Pb6rr57HUce/q63e5zPFNdSl/lijaAxImZz+Ob5wNcAJ9/S7vGOcv/U3eeKqgLl47knAXr92Xl+Jn59+637BZMNDz3z2Jrn/1RF6//vXvvQNdVQil95UIUonn+JYuxzDxZdrJ6jcLBrr+zVfR899+IjvTRx+rXey7PKV3sBcWcaBaw+NUfM5nMZQf7FgMf5B+7if+UXI5bf+xsvJWPHsnBTo7CDAG1epBcu+KB5qLV/nFxff4D5aHLO448QB+fLPozpUPDQPpHsSvIQdKj1DqeqTHpZVfcDEGnQ1EDjACZcYgkQQo+VlmFG/SLBjoxYcH+iiGtQeZz191lp/cP3/pkSzozvNUH+NrNwsGiudBqhNhBRLzm+QQdXl4R86FLg/348s78dwoMwRtwky6AZCYSd8UOLdEb1GzajGTlpeHyeWtkjtXPPTGAFnd8BUB1a4SEFAlIKCKGYjLEBABdajGQBVCBERABNShSkBAlYCAagok/23+yJsPNJutM5D7KCB1Gbot1IPKqgQEVBEDKR8CIqCOQOKvzwRUFAICqgQEVAkIqBIQUCUgoEpAQJWAgCoBAVUCqq7KvxoSEAG1rhpAXKjNI/sC0gvJnw0GP3pCQLnoheRikVm6GI+A0g5kLCSPjGu2W5LP2gAZC8l5VA/ysZBcriJPgVxvrUZzymIsJI+u791OpKgHJcn2IH3NdkvyWRug7BgUPU7WAdtuSS4zPZFGDqQXkps7GwEZXShdSH42GHgbg0wf5EAlsd2SXDJAZZ+qCwS0GNb5WJXtluSCGUiebBA8qY7tluSCG0id5bX6zFW2W5ILdiBFVHVCM9styQU70ESeFXdcsaPZbkkuqIHEub3Uh2ArupDtluSCGWgxrHOuQNstyQU3ENh9CCg0UNanTCgIUHJKTgacW9p2S7JBDKS/rqA6tluSDWqgerHdkmzwAvHuk5yGO9wYNJvhBULRgzYCyGVWgYI3MLN9tZsBs0Xb/1VmVoGKP/ITqgeNe9HkxqNJuMM8ciDegZajXsiJ4ooPOiBxGnMCkpcFQMvRnvguq3HAXQw3UDTv85cZVe8FBQAqFEJ9mLfdEjOrQMUzIQJCCsR3scAvNXADiWM89aDksgAo/NsdBT6YgJYjjEBFQqHGIGCKuPVA4d8PQg5UL7ZbYoaAgCp6oAlj+5PkpYZeSH59b+DnC7exA413v1TveIjoheRi+d31L30swUMOJN/u2E+OZXoR5zPB5GMRZ6EPWqCiZcCOF5IXA4V9Wzqz8YnYxcR7ZiKZta1iyWsc2/9VRoqBCt7wCDZIT8U0KF5gZvag5++nPtsNZMZYSH5974H+ue2WGFkvIL2QPOPjDmj1TxqogJLXGfqlRrqQXH2nvfOjGHIgkYlxlorS2G5JmhIfRECBF1CVAq0KERBOoGQXC7SQvAyoYC4ddh4EvK1ouyVp1gGoTmy3JA0BAdVSHwJSKQdaESIgAiKg5lUCAqoEVF2t8CGg8pfyKvkXGwS0zkBuUg0UsJnUg0qqBARU0QFV+RAQBJQ/0BMQARFQwyoBAVXAh4AgoOz3uhIQARFQsyros91A1a8zUqG6j0xA2wWU7EAEVFKt6UNAsFDdR/YFpFfam9+3TUBJ9Ep78aX27r7Tfm2BjFWuj2//w2kPquWDDiiz0j6WcrHSvjbQLMg79/W+st3xGFQXqOYjB+xBboBq+mADynxlOwog/dY9CiC90t4xUF0fY66IAsj4ynYCahLbLanvo0chAiIgAqpbbeKTChEQASVV80w+BFRQbQgUzxUJiIDiKrtqBhTPFQmoQgh+5A0CEs+WgCqqzY7xWmhbgBqO0FsH1OB1vBGxX24JUCsf/ED20g7Ic5uD9aD677SuhqHuQZZa0gmo7DTr3ZuFCKi9T/nZM7s3Cw9QFx/V+7oSVFfDAs267GDbAdTNBxiGNgCoq0/1MLT+QN19Sk9e16VZZjUokA2fqr1s3YFavUYtFOpEUF0NBTST+4YdoBkr6URrC5Q8KXsp7kRrDGSXZ1bSidYWyDqPItoUICc8hURrCeSMp4DIE5BeSG4uKW8BJL//1CGPIlKb8AikF5KbS8obAKUNv7J2XK+FpJo16ziNhIH0Is7Mcs5aQOn35rruOIVIyaYdA+llwPpafiE5K0npg/pMWePKU/gopY+vF5JnlpRb/KuGq6qnMaioBxGQkS5jUNiqt6PYQXoUO2hzFNt0IGMhecd5kO/qes6kPVYJiIAIyGk1MFD9dPn0ZqdPftrcMAEB9yUg4L4EBNwXxwtvxCEgIAQEhICAEBAQh0DivG36S2OaJPPugb/Nqje9cht3CPT4Afw7hcn+FcXbZtWXAOU37g7oxUefwL9UmOw7mN42q74EKL9xd0C8qxpniG6S7Hvg3jardrH8xt0BibNDt/vvzP4VxdtmFVB+426AHg8GajduNSB06kHtN+u7B8m0ammnMaj9ZhWQvzFI9NUXf2/zNLN/RfG2WQWU37jbedDtdvtJ13lQy836ngdtRggICAEBISAgBASEgIAQEBCEQBPG2M5R7ofz1/M/8RR8QPKU5VPolNzegg5oOZI0493T0C1RQQi0p68yxrvT/I0/sxv/5rtYfDua9+GTvlsLOiBxzntFtBz1+A63ezrv9+QYlN4Ww9G870kIH5AapbnFVPSWxXBfWnCV9PYbjzw2BiNQJBx2Tydqdfee6jGvHyW3o7H08xSkQBIkHqdTID1uL4ZyMPIRdEDxhEfsUvFkKAGampMjvqv5aQ86oGgsHMSAvBzxLsNVEqDkthyLvE0c8QHJMVoeyMRhnWslQMltcZxbnWq7CkIgXCEgIAQEhICAEBAQAgJCQEAICAgBASEgIP8HaPVyeGrNrhAAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma5-1" class="section level1">
<h1>sigma=5:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">5</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.2832</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=5&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma10-1" class="section level1">
<h1>sigma=10:</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
sigma =<span class="st"> </span><span class="dv">10</span>
L =<span class="st"> </span><span class="dv">10000</span>
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
AC_rate =<span class="st"> </span>k<span class="op">/</span>L
<span class="kw">print</span>(AC_rate)</code></pre></div>
<pre><code>## [1] 0.1616</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_<span class="dv">0</span> =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series,<span class="dv">1</span><span class="op">:</span>L))
LP =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Series,..density..),<span class="dt">bins =</span> <span class="dv">70</span>,<span class="dt">fill=</span><span class="st">'#FFCC00'</span>)<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun=</span>LP)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sigma=10&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))<span class="op">+</span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">'text'</span>,<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="fl">0.4</span>,<span class="dt">label=</span><span class="kw">as.character</span>(AC_rate))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABSlBMVEUAAAAAADUAADoAAF4AAGYANYQAOjoAOmYAOpAAXqgAZpAAZrYzMzM1ADU1hMk6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjsheAABeADVeqOtmAABmOgBmkJBmkLZmkNtmtpBmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SENQCEyeuOTU2OTW6OTY6Obk2OyP+QOgCQZgCQZjqQZmaQZraQkDqQkLaQtpCQttuQ2/+oXgCo6+urbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq2kDq2tpC2ttu225C229u22/+2///Ijk3I///JhDXJ6+vbkDrbtmbbtpDb27bb29vb/7bb///kq27k///rqF7ryYTr66jr68nr6+v/tmb/yI7/zAD/25D/27b/5Kv//7b//8j//9v//+T////rM7yxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALUElEQVR4nO2d/ZvbxBHHlyMpd7iNQ8vLOaWAoZQLhQu0jfvOhQSIoS9JSJy2OITkHJlzfPr/f+3ualfalSWN3nY1suf7PLl47Tlp9LnZF61HuywkFYp17QB2ESBABAgQAQJEgAARIEAECBABAoQF0HqyP6/+W9OB/O/Hdxn7xZ2WPVLqNaAZk4BWY8Z14W7rTglhAVRD669ZBGjG3pivv2GHTs7SNaD1nxjb+0BH0MMh2/v1ZBAuh4cPh3vvh4she00E1sOfc6v3daxE4bIa7/1mLABFv1qvjsLqGNB6Iq/3KLq+WXT1AtCrQ47k70NZ0u8f2YD+Ml9JQNHPcOqmjnUMaDl8fc5/DCQgHhOfhT9OJCD2QfiQ8VqzHO7P15MLd0JplVKEhoebKMz2Tlx42Dmgn7z3b/FCAFrIZkSAkDBWYx5Uqub87x9/HrJdBBRORYV57Y4EEV3iOmqD9OVP90WIqapnVrFwNwCF/3lXXm8RII7l1b/987txDqDVWALazjZI6r9/ZEfpKmYCWg6PwoI2aKt7sQUfwoTrb/ZO0o20DWgwF6PlDQK6/xLjoK+3cxykunnRU9ndvAlIGeUC2uqRtBwovj43Bopi9JdqpMW91kufbTYyClD0+ZbfiyVSbS4WYQK0HL7MQ2nKjrp2xBQmQHGD1LUjpjABihskTEIFCKMIECACBIgAASJAgKoDOs1Q5ptVTfxYlD1ICUDPPx29+b189Wg0Gv3yWwJk6/zm9fDRr+TLe9cpgjIC6Pffhme/FXFzfus2AdrU2cffh89/dzuqa6ORDKKfcuX+wnYqH9CzNzWgsw9vG1Hk9g/n3MJFBEnF7ZBbv5xbuGiDCFCmzm8eq15MVLbzL6ib3wghOQ4SQcTHQVfiuubWL+cWLQLKkVu/CsVaOAYBaskRAgRYECDAggABFn0ExEKQEAFqfBYC1JIjBAiwIECABQECLAgQYEGAAIseAmJB0AtAnYkDCvy7268IAkMIQwS59atABAj4nAABnxMg4HMCBHxOgIDPCRDwOQECPheAoFnXXQbETglQoQgQAWpmQYAIUDMLAuQA0A3GLj7QhSdvfyL+m+r3VNmySQ5SAlCSJx3lBPcP0P2LD55eO9ClGy8IIDcO+T9JRJUv6bJ9EBiQkSctUsl7COjJW++cnj5+8XNVYALIDz87ET8+Scr6R+ogMCAzR/Hsoz8gAQQQso4hr1tS4np8IIuPL85P7fKD7IPAgIws1/NbX93sPE+ahRxQpUZzIR6TXo31I7DLyydhOBss9BPk6XLeafOU5EmHj47RtEFVIkjWridvXVJFGTE32ECHjSofbIRR5Qjir7oHxMHUBPSOKkZARBWL3lPlB6ZNchAYUNIGiYd9RqPjjgEFQaM2SBXvH4QWoPuik6sHKMmTDjF08zUAWb2YAvL4xbt6BKTKn8cjIusgMCAjT7qngET9McZBEsjTa4dyfJSUL+myfZASgHJU/dpKmrQPSIySDxQEPdp5OtEjZ1W+VnskvQWAGjhCgAALAgRYECDAoreAigkRIAKUJwJUbBHxIUC5IkAEqJkFAdoeQN1IAQq9e0wRlGPRU0BQDhUBAr4aI0AEKFvyOx8ClC8DUMCCJmchQC05QoAACwIEWBAgwIIAARYECLDoMaCimw0CRIAyFSUHEaBc4QSUpAE/M1ZLJkBaSRqwXEpRp1IRoDiArKVKk1du/coWSkD2YrdRBHWVBsy9NAF5PnWs1djcBc9IAw7Prna7VCmaCJoaO+vYEZS8cutXtmxABYTcVzGxmVm0fRWm5ZIRAYoQidx8e7nkTiNIAMECaCa3xhXbwiFaLpkFtjoDJDb4ko9+LAoe73DrV6awAFqNy2yk6NavTOEBBIYPASJAuYDUJqeMbW46jQ1Q/neHXiIIkFu/MoUFUDm59StL1nRiZ4B4+Oi9uLG1QTgAUQTZFgQIsMgEFFUzYLTo1q8s4QE0HYSzC3dn2Lp5NIB4AK0nA3wDxU1AuYScAxJ7mWMDFKSHQZ0BWk8OF3snoqKh0gafagtUND27WVgO+W3GFNjO3O0fLkObgPLvxnaymydAgAUiQLyKIbzVwANI9PE9iSDRs7l1JAsQ0ukOPIDWE4yAMvl0AwgaIu48IJzzQYgAlZNbvzZFgAALVIBmjB3NkN1qZAPKyZZ2PR+0/10040GA8qc7jpBNd2xMBhEgW5gAhTNRxcScGR5Am7NlXQIKF2IYpPkkedJnV0ddrQaMDJCpJE9aZJedfdhNhlkuoOwbep+AkhzFZwJTRzmKeADp+4z4ViMry9V/nnQuH1/Z0nYjbS7AbKVuioxOJbd/uLQKALl1JAuQnUBlRtDzT2M+BEgDMvKkz65eDwlQUsUO41qlnvYx+aABlEnIyzhITyvGedLRgtvd9GLIAJVRvZPWBFTAhwAJESDAggABFgQIsCgClJUDs2uA8iaDVAht3tATIAJkiQABFgQIsCgGlNGP7Rig1LO8BCgtAgRY9BOQR9krUmQR8uJDRdX7qziJoM0QwhBB9U5aB1B6PQEClBIBAiwIEGABA9q4od8pQMAwmgARoGKL/G/lLUCBlaxIgNJiuwuoFB8CRIByLcoBSiVMEyACpFWSDwEiQDkWZQHZU/deASVpwOZat54AlRhGdw0oSQMWC0r7Xk+6B4CMFLx7V77EG0HWnIdPQFYasCLlLQ0YnI02Abn2JEdWGrDvNqh0E40sgjwACqKNDCsACthpfE/fURvkHVAlPl0BStKAfQMKys10dA3IWC7ZGyB9xZX4mNNm2z6SJkCARU1Ap/Gs0G4AqsiHAJUDJF/sBKCqfJJxEwEiQHX4CEDRb+0EoOp8CFApsR0BVJfPrgCqzUfN3hOgQkLbD6gJn10A1IiPnPbAAMihGgJyMjuNKYIqfJORrVOGIYLqnbSECZg2DgPKX+y+iiNoATXEI7t5mFBvATXns72AAj1t2hwQXMl6CqiF+JGANpLyaviKEVArfJSijKFcTL0E1CYfle+xVYDa5RPH47YAYm3z4YT0IXsMKFAtBWs+PixA1HtADqInRtR/QIFDPPLomcuZ9geQWzyKUe8ABVHYi8XknOOJEQVmXWsPUJIGbCYENwbEvMHRiBhzAihJAzYTgusDEn9Gz2wsSCyqb/F7jQElKXhWMl6KRXSmPECWe8xRj15WUcVmOoJN/wPr7qQkoCSJM3mVTgNmpZR7iu5U3tEyacBWQrDTbzU8WLTXBmVFEAEyVK4Natsv5xZt9mLHcS923EIvhsSi9XGQCJ0Wx0GdW2AfSXduQYBaOggBAiwIEGBRH1BNtfEgXisP81U8CAECRIAAESBAGG+1UYkAASJAgAgQIAIEyBcgsT9Qsv5HHVlTCv7c8AXo3nXYplD2Vyv+3PAE6PzWbdioUPa0pj83PAHi9cPYibSO7Ilxf254AiR2IW0WRfZXK/7c8ADo3mgUtR2N2qFWIqiGGz67+UaAWmmDarjhCZCoIOdfNLk8+6sVf254HAddaVY/2hoHVXSDRtKACBAgAgSIAAEiQIAIECACBAghoBljbO8k9ebycvodT8IHSG5Zvoi35O5a6ACtJxLNdH/etSeREAI6TF4yxsNp+cpf2YV/8SqmyuFyaGz67lroAIk97yNE68mAV7j9+XI4kG1QXBbN0XLoiRA+QFErzVksRLSsxkeSBacSl1+569EZjIBCwWF/Pouyuw+jiLl8osvhVPLzJKSAJBDVTseAknZ7NZaNkQ+hA6QGPKJKqcGQBrQwB0e8qvnxBx2gcCo4iAZ5PeEhw6loQLos2yJvA0d8gGQbLTsy0a1zWhqQLot+bnOo7UoIAeESAQJEgAARIEAECBABAkSAABEgQAQIEAEC9H/SLytIpACZWAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DATA_last =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Series[<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>],<span class="dv">9000</span><span class="op">:</span><span class="dv">10000</span>))
<span class="kw">ggplot</span>(<span class="dt">data =</span> DATA_<span class="dv">0</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,Series))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;all steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>DATA_last)<span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(V2,V1))<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;last 1000 steps&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see as the increase of <span class="math inline">\(\sigma\)</span>, the acceptance rate becomes lower. Since 0 is the center of Laplace distribution, we can’t see obvious difference of the converge rates.</p>
</div>
<div id="section-17" class="section level1">
<h1>12-13</h1>
</div>
<div id="question-1-1" class="section level1">
<h1>Question 1</h1>
<ol start="3" style="list-style-type: decimal">
<li>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt ) #Answer 1</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mtcars)
formulas =<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)
<span class="co"># for loop</span>
result_<span class="dv">1</span> =<span class="st"> </span><span class="kw">list</span>()
<span class="cf">for</span> (i <span class="cf">in</span> formulas){
  result_<span class="dv">1</span> =<span class="st"> </span><span class="kw">c</span>(result_<span class="dv">1</span>,<span class="kw">list</span>(<span class="kw">lm</span>(<span class="dt">data=</span>mtcars,i)))
}
<span class="co">#lapply</span>
result_<span class="dv">2</span> =<span class="st"> </span><span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars)
<span class="kw">print</span>(result_<span class="dv">1</span>)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(result_<span class="dv">2</span>)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question2" class="section level1">
<h1>Question2</h1>
<ol start="4" style="list-style-type: decimal">
<li>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</li>
</ol>
</div>
<div id="answer2" class="section level1">
<h1>Answer2</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
mtcars[rows, ]
})
<span class="co">#for loop</span>
result1 =<span class="st"> </span><span class="kw">list</span>()
<span class="cf">for</span>(i <span class="cf">in</span> bootstraps){
  result1 =<span class="st"> </span><span class="kw">c</span>(result1,<span class="kw">list</span>(<span class="kw">lm</span>(<span class="dt">data =</span> i,mpg<span class="op">~</span>disp)))
}
<span class="co">#lapply</span>
result2 =<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm,<span class="dt">formula =</span> mpg<span class="op">~</span>disp)
<span class="kw">print</span>(result1)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    29.04700     -0.04087  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    31.80115     -0.04822  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    31.23243     -0.04867  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##     29.9118      -0.0414  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    28.38694     -0.04045  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.49599     -0.04255  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    29.49939     -0.04225  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    27.27364     -0.03138  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    29.44656     -0.04126  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##     30.2208      -0.0463</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(result2)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.04700     -0.04087  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.80115     -0.04822  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23243     -0.04867  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.9118      -0.0414  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.38694     -0.04045  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.49599     -0.04255  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.49939     -0.04225  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.27364     -0.03138  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44656     -0.04126  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.2208      -0.0463</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#without anonymous function:</span>
bootstraps =<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">rep</span>(<span class="kw">list</span>(mtcars),<span class="dv">10</span>),<span class="dt">FUN =</span> <span class="st">'['</span>, <span class="dt">i =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars),<span class="dt">rep=</span><span class="ot">TRUE</span>),<span class="dt">j=</span><span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mtcars) )
<span class="co">#for loop</span>
result3 =<span class="st"> </span><span class="kw">list</span>()
<span class="cf">for</span>(i <span class="cf">in</span> bootstraps){
  result3 =<span class="st"> </span><span class="kw">c</span>(result3,<span class="kw">list</span>(<span class="kw">lm</span>(<span class="dt">data =</span> i,mpg<span class="op">~</span>disp)))
}
<span class="co">#lapply</span>
result4 =<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm,<span class="dt">formula =</span> mpg<span class="op">~</span>disp)
<span class="kw">print</span>(result3)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(result4)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.88013     -0.04623</code></pre>
</div>
<div id="question3" class="section level1">
<h1>Question3</h1>
<ol start="5" style="list-style-type: decimal">
<li>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared #Answer3</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared
<span class="co">#question 1</span>
R_<span class="dv">1</span> =<span class="st"> </span><span class="kw">lapply</span>(result_<span class="dv">1</span>,rsq)
R_<span class="dv">2</span> =<span class="st"> </span><span class="kw">lapply</span>(result_<span class="dv">2</span>,rsq)
<span class="co">#question 2</span>
R1 =<span class="st"> </span><span class="kw">lapply</span>(result1, rsq)
R2 =<span class="st"> </span><span class="kw">lapply</span>(result2, rsq)
<span class="kw">print</span>(R_<span class="dv">1</span>)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(R_<span class="dv">2</span>)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(R1)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7214869
## 
## [[2]]
## [1] 0.7981159
## 
## [[3]]
## [1] 0.7656215
## 
## [[4]]
## [1] 0.7463241
## 
## [[5]]
## [1] 0.728403
## 
## [[6]]
## [1] 0.8006626
## 
## [[7]]
## [1] 0.6552779
## 
## [[8]]
## [1] 0.6444812
## 
## [[9]]
## [1] 0.7101062
## 
## [[10]]
## [1] 0.7298773</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(R2)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7214869
## 
## [[2]]
## [1] 0.7981159
## 
## [[3]]
## [1] 0.7656215
## 
## [[4]]
## [1] 0.7463241
## 
## [[5]]
## [1] 0.728403
## 
## [[6]]
## [1] 0.8006626
## 
## [[7]]
## [1] 0.6552779
## 
## [[8]]
## [1] 0.6444812
## 
## [[9]]
## [1] 0.7101062
## 
## [[10]]
## [1] 0.7298773</code></pre>
</div>
<div id="question4" class="section level1">
<h1>Question4</h1>
<ol start="3" style="list-style-type: decimal">
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly #Answer4</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
<span class="dv">100</span>,
<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
<span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
<span class="co"># Using anonymous function </span>
result_anonymous =<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(i) i<span class="op">$</span>p.value)
<span class="co"># Don't use anonymous fnction</span>
result_NO_anonymous =<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="st">'[['</span>,<span class="dt">i=</span><span class="dv">3</span>)
<span class="kw">print</span>(result_anonymous)</code></pre></div>
<pre><code>##   [1] 0.283131204 0.625114584 0.957434662 0.321852959 0.489196580
##   [6] 0.294734573 0.980164665 0.648486748 0.957828242 0.106279769
##  [11] 0.085021219 0.499012234 0.402325783 0.474767616 0.711664450
##  [16] 0.064639268 0.117756870 0.126527833 0.095149487 0.016250829
##  [21] 0.500394142 0.635842438 0.450936711 0.083346500 0.432630520
##  [26] 0.151412640 0.778092729 0.608925621 0.007376517 0.128292741
##  [31] 0.413928599 0.173732877 0.891018848 0.136253983 0.625908470
##  [36] 0.022622792 0.880121374 0.158537068 0.065036368 0.568245624
##  [41] 0.258717524 0.253309016 0.376032049 0.711103288 0.551178558
##  [46] 0.681703206 0.939956376 0.282127943 0.666284309 0.431363478
##  [51] 0.787879448 0.647479758 0.131924531 0.420673818 0.074901388
##  [56] 0.921028725 0.695868733 0.717876668 0.743537710 0.930388646
##  [61] 0.992272264 0.439890487 0.855906880 0.107645275 0.793383138
##  [66] 0.589539117 0.371098585 0.706634559 0.945746170 0.300903116
##  [71] 0.795014011 0.850732072 0.356035714 0.261653828 0.839024781
##  [76] 0.853323646 0.795465073 0.180608071 0.114008229 0.616067103
##  [81] 0.196922035 0.864106601 0.759562744 0.094588528 0.054958263
##  [86] 0.247396017 0.912978507 0.581668766 0.453220430 0.088185080
##  [91] 0.942751889 0.607889867 0.660495254 0.535005989 0.602719082
##  [96] 0.926792628 0.801814706 0.875452239 0.911576046 0.464043741</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(result_NO_anonymous)</code></pre></div>
<pre><code>##   [1] 0.283131204 0.625114584 0.957434662 0.321852959 0.489196580
##   [6] 0.294734573 0.980164665 0.648486748 0.957828242 0.106279769
##  [11] 0.085021219 0.499012234 0.402325783 0.474767616 0.711664450
##  [16] 0.064639268 0.117756870 0.126527833 0.095149487 0.016250829
##  [21] 0.500394142 0.635842438 0.450936711 0.083346500 0.432630520
##  [26] 0.151412640 0.778092729 0.608925621 0.007376517 0.128292741
##  [31] 0.413928599 0.173732877 0.891018848 0.136253983 0.625908470
##  [36] 0.022622792 0.880121374 0.158537068 0.065036368 0.568245624
##  [41] 0.258717524 0.253309016 0.376032049 0.711103288 0.551178558
##  [46] 0.681703206 0.939956376 0.282127943 0.666284309 0.431363478
##  [51] 0.787879448 0.647479758 0.131924531 0.420673818 0.074901388
##  [56] 0.921028725 0.695868733 0.717876668 0.743537710 0.930388646
##  [61] 0.992272264 0.439890487 0.855906880 0.107645275 0.793383138
##  [66] 0.589539117 0.371098585 0.706634559 0.945746170 0.300903116
##  [71] 0.795014011 0.850732072 0.356035714 0.261653828 0.839024781
##  [76] 0.853323646 0.795465073 0.180608071 0.114008229 0.616067103
##  [81] 0.196922035 0.864106601 0.759562744 0.094588528 0.054958263
##  [86] 0.247396017 0.912978507 0.581668766 0.453220430 0.088185080
##  [91] 0.942751889 0.607889867 0.660495254 0.535005989 0.602719082
##  [96] 0.926792628 0.801814706 0.875452239 0.911576046 0.464043741</code></pre>
</div>
<div id="question5" class="section level1">
<h1>Question5</h1>
<ol start="7" style="list-style-type: decimal">
<li>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not? #Answer5</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#mcsapply</span>
mcsapply =<span class="st"> </span><span class="cf">function</span>(X,FUN,<span class="dt">mc.preschedule =</span> <span class="ot">TRUE</span>, <span class="dt">mc.set.seed =</span> <span class="ot">TRUE</span>,<span class="dt">mc.silent =</span> <span class="ot">FALSE</span>, <span class="dt">mc.cores =</span> 1L,<span class="dt">mc.cleanup =</span> <span class="ot">TRUE</span>, <span class="dt">mc.allow.recursive =</span> <span class="ot">TRUE</span>,<span class="dt">affinity.list =</span> <span class="ot">NULL</span>,...){
  temp =<span class="st"> </span>parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dt">X=</span>X,<span class="dt">FUN=</span>FUN,<span class="dt">mc.preschedule =</span> mc.preschedule, <span class="dt">mc.set.seed =</span> mc.set.seed,<span class="dt">mc.silent =</span> mc.silent, <span class="dt">mc.cores =</span> mc.cores,<span class="dt">mc.cleanup =</span> mc.cleanup, <span class="dt">mc.allow.recursive =</span> mc.allow.recursive,<span class="dt">affinity.list =</span> affinity.list,<span class="dt">... =</span> ...)
  <span class="kw">return</span>(<span class="kw">unlist</span>(temp))
}
<span class="co">#mcvapply</span>
mcvapply =<span class="st"> </span><span class="cf">function</span>(X,FUN,<span class="dt">mc.preschedule =</span> <span class="ot">TRUE</span>, <span class="dt">mc.set.seed =</span> <span class="ot">TRUE</span>,<span class="dt">mc.silent =</span> <span class="ot">FALSE</span>, <span class="dt">mc.cores =</span> 1L,<span class="dt">mc.cleanup =</span> <span class="ot">TRUE</span>, <span class="dt">mc.allow.recursive =</span> <span class="ot">TRUE</span>,<span class="dt">affinity.list =</span> <span class="ot">NULL</span>,<span class="dt">FUN.VALUE=</span><span class="ot">NULL</span>,...){
  temp =<span class="st"> </span>parallel<span class="op">::</span><span class="kw">mclapply</span>(<span class="dt">X=</span>X,<span class="dt">FUN=</span>FUN,<span class="dt">mc.preschedule =</span> mc.preschedule, <span class="dt">mc.set.seed =</span> mc.set.seed,<span class="dt">mc.silent =</span> mc.silent, <span class="dt">mc.cores =</span> mc.cores,<span class="dt">mc.cleanup =</span> mc.cleanup, <span class="dt">mc.allow.recursive =</span> mc.allow.recursive,<span class="dt">affinity.list =</span> affinity.list,<span class="dt">... =</span> ...)
  is_FUN_VALUE =<span class="st"> </span><span class="kw">sapply</span>(temp, <span class="cf">function</span>(i){
    a =<span class="st"> </span>(<span class="kw">mode</span>(i)<span class="op">==</span><span class="kw">mode</span>(FUN.VALUE))
    b =<span class="st"> </span>(<span class="kw">length</span>(i)<span class="op">==</span><span class="kw">length</span>(FUN.VALUE))
    <span class="kw">return</span>(a<span class="op">&amp;</span>b)
  })
  <span class="cf">if</span>(<span class="kw">sum</span>(is_FUN_VALUE)<span class="op">==</span><span class="kw">length</span>(is_FUN_VALUE)){
    <span class="kw">return</span>(<span class="kw">unlist</span>(temp))
  }
  <span class="cf">else</span>{
    <span class="kw">stop</span>(<span class="st">&quot;FUN.VALUE doesn't match the shape of return values&quot;</span>)
  }
}</code></pre></div>
</div>
<div id="section-18" class="section level1">
<h1>12-20</h1>
</div>
<div id="question-4" class="section level1">
<h1>Question</h1>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
<p>Rewrite an Rcpp function for the same task.</p>
<p>Compare the generated random numbers by the two functions using qqplot.</p>
<p>Campare the computation time of the two functions with microbenchmark. I Comments your results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
<span class="kw">library</span>(Rcpp)
RF =<span class="st"> </span><span class="cf">function</span>(L,sigma){
Series =<span class="st"> </span><span class="kw">numeric</span>(L)
Uniform =<span class="st"> </span><span class="kw">runif</span>(L)
k=<span class="dv">0</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>L){
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Series[i<span class="op">-</span><span class="dv">1</span>],sigma)
  <span class="cf">if</span>(Uniform[i]<span class="op">&lt;=</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)<span class="op">+</span><span class="kw">abs</span>(Series[i<span class="op">-</span><span class="dv">1</span>]))){
    Series[i] =<span class="st"> </span>y
    k=k<span class="op">+</span><span class="dv">1</span>
  }
  <span class="cf">else</span>{
    Series[i] =<span class="st"> </span>Series[i<span class="op">-</span><span class="dv">1</span>]
  }
}
<span class="kw">return</span>(Series)
}
<span class="co">#sourceCpp('CF.cpp')</span>
<span class="co">#qqplot(RF(10000,1),CF(10000,1))</span>
<span class="co">#COMP = summary(microbenchmark(RF(1000,1),CF(1000,1)))</span>
<span class="co">#knitr::kable(COMP)</span></code></pre></div>
<p>According to the result of microbenchmark, C is about 20 times faster than R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #Cpp function</span>
<span class="co"># include&lt;Rcpp.h&gt;</span>
<span class="co"># include&lt;Rmath.h&gt;</span>
<span class="co"># include&lt;cmath&gt;</span>
<span class="co"># using namespace Rcpp;</span>
<span class="co"># //[[Rcpp::export]]</span>
<span class="co"># NumericVector CF(int L, double sigma) {</span>
<span class="co">#   NumericVector Series (L);</span>
<span class="co">#   NumericVector Uniform = runif(L);</span>
<span class="co">#   int k=0;</span>
<span class="co">#   for (int i =1; i&lt;L; i++){</span>
<span class="co">#     NumericVector y = rnorm(1,Series[i-1],sigma);</span>
<span class="co">#     if(Uniform[i]&lt;=exp(-fabs(y[0])+fabs(Series[i-1]))){</span>
<span class="co">#       Series[i] = y[0];</span>
<span class="co">#       k=k+1;</span>
<span class="co">#     }</span>
<span class="co">#     else{</span>
<span class="co">#       Series[i] = Series[i-1];</span>
<span class="co">#     }</span>
<span class="co">#   }</span>
<span class="co">#   return Series;</span>
<span class="co"># }</span></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
